<!-- START doctoc generated TOC please keep comment here to allow auto update -->
<!-- DON'T EDIT THIS SECTION, INSTEAD RE-RUN doctoc TO UPDATE -->
<!-- **Table of Contents**  *generated with [DocToc](https://github.com/thlorenz/doctoc)* -->

- [(ã€‡)é‡è¦æ¦‚å¿µ](#%E3%80%87%E9%87%8D%E8%A6%81%E6%A6%82%E5%BF%B5)
- [(ä¸€) å˜é‡](#%E4%B8%80-%E5%8F%98%E9%87%8F)
  - [1 å˜é‡åŸºç¡€](#1-%E5%8F%98%E9%87%8F%E5%9F%BA%E7%A1%80)
    - [é»˜è®¤å€¼](#%E9%BB%98%E8%AE%A4%E5%80%BC)
    - [late å˜é‡](#late-%E5%8F%98%E9%87%8F)
    - [Final å’Œ Const](#final-%E5%92%8C-const)
  - [notes](#notes)
- [(äºŒ)å†…ç½®ç±»å‹](#%E4%BA%8C%E5%86%85%E7%BD%AE%E7%B1%BB%E5%9E%8B)
  - [Dart è¯­è¨€æ”¯æŒä¸‹åˆ—å†…å®¹](#dart-%E8%AF%AD%E8%A8%80%E6%94%AF%E6%8C%81%E4%B8%8B%E5%88%97%E5%86%85%E5%AE%B9)
  - [Numbers](#numbers)
  - [Strings](#strings)
  - [å¸ƒå°”ç±»å‹](#%E5%B8%83%E5%B0%94%E7%B1%BB%E5%9E%8B)
  - [Lists](#lists)
  - [Sets](#sets)
  - [Maps](#maps)
  - [Runes ä¸ grapheme clusters](#runes-%E4%B8%8E-grapheme-clusters)
  - [Symbols](#symbols)
- [(ä¸‰) å‡½æ•°](#%E4%B8%89-%E5%87%BD%E6%95%B0)
  - [å‚æ•°](#%E5%8F%82%E6%95%B0)
  - [main() å‡½æ•°](#main-%E5%87%BD%E6%95%B0)
  - [å‡½æ•°æ˜¯ä¸€çº§å¯¹è±¡](#%E5%87%BD%E6%95%B0%E6%98%AF%E4%B8%80%E7%BA%A7%E5%AF%B9%E8%B1%A1)
  - [åŒ¿åå‡½æ•°](#%E5%8C%BF%E5%90%8D%E5%87%BD%E6%95%B0)
  - [è¯æ³•ä½œç”¨åŸŸ](#%E8%AF%8D%E6%B3%95%E4%BD%9C%E7%94%A8%E5%9F%9F)
  - [è¯æ³•é—­åŒ…](#%E8%AF%8D%E6%B3%95%E9%97%AD%E5%8C%85)
  - [æµ‹è¯•å‡½æ•°æ˜¯å¦ç›¸ç­‰](#%E6%B5%8B%E8%AF%95%E5%87%BD%E6%95%B0%E6%98%AF%E5%90%A6%E7%9B%B8%E7%AD%89)
  - [è¿”å›å€¼](#%E8%BF%94%E5%9B%9E%E5%80%BC)
  - [notes](#notes-1)
- [(å››)è¿ç®—ç¬¦](#%E5%9B%9B%E8%BF%90%E7%AE%97%E7%AC%A6)
  - [ç®—æœ¯è¿ç®—ç¬¦](#%E7%AE%97%E6%9C%AF%E8%BF%90%E7%AE%97%E7%AC%A6)
  - [å…³ç³»è¿ç®—ç¬¦](#%E5%85%B3%E7%B3%BB%E8%BF%90%E7%AE%97%E7%AC%A6)
  - [ç±»å‹åˆ¤æ–­è¿ç®—ç¬¦](#%E7%B1%BB%E5%9E%8B%E5%88%A4%E6%96%AD%E8%BF%90%E7%AE%97%E7%AC%A6)
  - [èµ‹å€¼è¿ç®—ç¬¦](#%E8%B5%8B%E5%80%BC%E8%BF%90%E7%AE%97%E7%AC%A6)
  - [é€»è¾‘è¿ç®—ç¬¦](#%E9%80%BB%E8%BE%91%E8%BF%90%E7%AE%97%E7%AC%A6)
  - [æŒ‰ä½å’Œç§»ä½è¿ç®—ç¬¦](#%E6%8C%89%E4%BD%8D%E5%92%8C%E7%A7%BB%E4%BD%8D%E8%BF%90%E7%AE%97%E7%AC%A6)
  - [æ¡ä»¶è¡¨è¾¾å¼](#%E6%9D%A1%E4%BB%B6%E8%A1%A8%E8%BE%BE%E5%BC%8F)
  - [çº§è”è¿ç®—ç¬¦](#%E7%BA%A7%E8%81%94%E8%BF%90%E7%AE%97%E7%AC%A6)
  - [å…¶ä»–è¿ç®—ç¬¦](#%E5%85%B6%E4%BB%96%E8%BF%90%E7%AE%97%E7%AC%A6)
- [(äº”) æ§åˆ¶æµç¨‹è¯­å¥](#%E4%BA%94-%E6%8E%A7%E5%88%B6%E6%B5%81%E7%A8%8B%E8%AF%AD%E5%8F%A5)
  - [åŸºç¡€æ§åˆ¶æµç¨‹è¯­å¥](#%E5%9F%BA%E7%A1%80%E6%8E%A7%E5%88%B6%E6%B5%81%E7%A8%8B%E8%AF%AD%E5%8F%A5)
  - [note](#note)
- [(å…­) ç±»](#%E5%85%AD-%E7%B1%BB)
  - [ä½¿ç”¨ç±»](#%E4%BD%BF%E7%94%A8%E7%B1%BB)
    - [ä½¿ç”¨ç±»çš„æˆå‘˜](#%E4%BD%BF%E7%94%A8%E7%B1%BB%E7%9A%84%E6%88%90%E5%91%98)
    - [ä½¿ç”¨æ„é€ å‡½æ•°](#%E4%BD%BF%E7%94%A8%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0)
    - [è·å–å¯¹è±¡çš„ç±»å‹](#%E8%8E%B7%E5%8F%96%E5%AF%B9%E8%B1%A1%E7%9A%84%E7%B1%BB%E5%9E%8B)
  - [å®ç°ä¸€ä¸ªç±»(ç±»åŒ…å«çš„ä¸œè¥¿)](#%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E7%B1%BB%E7%B1%BB%E5%8C%85%E5%90%AB%E7%9A%84%E4%B8%9C%E8%A5%BF)
    - [å®ä¾‹å˜é‡(Instance variables)](#%E5%AE%9E%E4%BE%8B%E5%8F%98%E9%87%8Finstance-variables)
    - [æ„é€ å‡½æ•°(constructors)](#%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0constructors)
      - [ç»ˆå€¼åˆå§‹åŒ–](#%E7%BB%88%E5%80%BC%E5%88%9D%E5%A7%8B%E5%8C%96)
      - [é»˜è®¤æ„é€ å‡½æ•°](#%E9%BB%98%E8%AE%A4%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0)
      - [æ„é€ å‡½æ•°ä¸è¢«ç»§æ‰¿](#%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0%E4%B8%8D%E8%A2%AB%E7%BB%A7%E6%89%BF)
      - [å‘½åå¼æ„é€ å‡½æ•°](#%E5%91%BD%E5%90%8D%E5%BC%8F%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0)
      - [è°ƒç”¨çˆ¶ç±»éé»˜è®¤æ„é€ å‡½æ•°](#%E8%B0%83%E7%94%A8%E7%88%B6%E7%B1%BB%E9%9D%9E%E9%BB%98%E8%AE%A4%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0)
      - [åˆå§‹åŒ–åˆ—è¡¨](#%E5%88%9D%E5%A7%8B%E5%8C%96%E5%88%97%E8%A1%A8)
      - [é‡å®šå‘æ„é€ å‡½æ•°](#%E9%87%8D%E5%AE%9A%E5%90%91%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0)
      - [å¸¸é‡æ„é€ å‡½æ•°](#%E5%B8%B8%E9%87%8F%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0)
      - [å·¥å‚æ„é€ å‡½æ•°](#%E5%B7%A5%E5%8E%82%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0)
    - [æ–¹æ³•(Methods)](#%E6%96%B9%E6%B3%95methods)
      - [å®ä¾‹æ–¹æ³•](#%E5%AE%9E%E4%BE%8B%E6%96%B9%E6%B3%95)
      - [æ“ä½œç¬¦](#%E6%93%8D%E4%BD%9C%E7%AC%A6)
      - [Getter å’Œ Setter](#getter-%E5%92%8C-setter)
      - [æŠ½è±¡æ–¹æ³•](#%E6%8A%BD%E8%B1%A1%E6%96%B9%E6%B3%95)
    - [æŠ½è±¡ç±»(Abstract classes)](#%E6%8A%BD%E8%B1%A1%E7%B1%BBabstract-classes)
    - [éšå¼æ¥å£ï¼ˆImplicit interfacesï¼‰](#%E9%9A%90%E5%BC%8F%E6%8E%A5%E5%8F%A3implicit-interfaces)
    - [æ‰©å±•ï¼ˆextendsã€ç»§æ‰¿ï¼‰ä¸€ä¸ªç±»](#%E6%89%A9%E5%B1%95extends%E7%BB%A7%E6%89%BF%E4%B8%80%E4%B8%AA%E7%B1%BB)
      - [é‡å†™(override)ç±»æˆå‘˜](#%E9%87%8D%E5%86%99override%E7%B1%BB%E6%88%90%E5%91%98)
      - [noSuchMethod æ–¹æ³•](#nosuchmethod-%E6%96%B9%E6%B3%95)
    - [æ‰©å±•æ–¹æ³•(Extension methods)](#%E6%89%A9%E5%B1%95%E6%96%B9%E6%B3%95extension-methods)
    - [æšä¸¾ç±»å‹](#%E6%9E%9A%E4%B8%BE%E7%B1%BB%E5%9E%8B)
      - [ä½¿ç”¨æšä¸¾](#%E4%BD%BF%E7%94%A8%E6%9E%9A%E4%B8%BE)
    - [ä½¿ç”¨ Mixin ä¸ºç±»æ·»åŠ åŠŸèƒ½](#%E4%BD%BF%E7%94%A8-mixin-%E4%B8%BA%E7%B1%BB%E6%B7%BB%E5%8A%A0%E5%8A%9F%E8%83%BD)
    - [ç±»å˜é‡å’Œæ–¹æ³•(Class variables and methods)](#%E7%B1%BB%E5%8F%98%E9%87%8F%E5%92%8C%E6%96%B9%E6%B3%95class-variables-and-methods)
      - [é™æ€å˜é‡](#%E9%9D%99%E6%80%81%E5%8F%98%E9%87%8F)
      - [é™æ€æ–¹æ³•](#%E9%9D%99%E6%80%81%E6%96%B9%E6%B3%95)
  - [(ä¸ƒ) æ³›å‹](#%E4%B8%83-%E6%B3%9B%E5%9E%8B)
    - [ä¸ºä»€ä¹ˆä½¿ç”¨æ³›å‹ï¼Ÿ](#%E4%B8%BA%E4%BB%80%E4%B9%88%E4%BD%BF%E7%94%A8%E6%B3%9B%E5%9E%8B)
    - [ä½¿ç”¨é›†åˆå­—é¢é‡(Using collection literals)](#%E4%BD%BF%E7%94%A8%E9%9B%86%E5%90%88%E5%AD%97%E9%9D%A2%E9%87%8Fusing-collection-literals)
    - [ä½¿ç”¨ç±»å‹å‚æ•°åŒ–çš„æ„é€ å‡½æ•°](#%E4%BD%BF%E7%94%A8%E7%B1%BB%E5%9E%8B%E5%8F%82%E6%95%B0%E5%8C%96%E7%9A%84%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0)
    - [æ³›å‹é›†åˆä»¥åŠå®ƒä»¬æ‰€åŒ…å«çš„ç±»å‹](#%E6%B3%9B%E5%9E%8B%E9%9B%86%E5%90%88%E4%BB%A5%E5%8F%8A%E5%AE%83%E4%BB%AC%E6%89%80%E5%8C%85%E5%90%AB%E7%9A%84%E7%B1%BB%E5%9E%8B)
    - [é™åˆ¶å‚æ•°åŒ–ç±»å‹](#%E9%99%90%E5%88%B6%E5%8F%82%E6%95%B0%E5%8C%96%E7%B1%BB%E5%9E%8B)
    - [ä½¿ç”¨æ³›å‹æ–¹æ³•](#%E4%BD%BF%E7%94%A8%E6%B3%9B%E5%9E%8B%E6%96%B9%E6%B3%95)
  - [(å…«) åº“å’Œå¯è§æ€§(Libraries and visibility)](#%E5%85%AB-%E5%BA%93%E5%92%8C%E5%8F%AF%E8%A7%81%E6%80%A7libraries-and-visibility)
    - [ä½¿ç”¨åº“](#%E4%BD%BF%E7%94%A8%E5%BA%93)
    - [æŒ‡å®šåº“å‰ç¼€](#%E6%8C%87%E5%AE%9A%E5%BA%93%E5%89%8D%E7%BC%80)
    - [å¯¼å…¥åº“çš„ä¸€éƒ¨åˆ†](#%E5%AF%BC%E5%85%A5%E5%BA%93%E7%9A%84%E4%B8%80%E9%83%A8%E5%88%86)
    - [å»¶è¿ŸåŠ è½½(æ‡’åŠ è½½)åº“](#%E5%BB%B6%E8%BF%9F%E5%8A%A0%E8%BD%BD%E6%87%92%E5%8A%A0%E8%BD%BD%E5%BA%93)
  - [(ä¹) å¼‚æ­¥æ”¯æŒ(Asynchrony support)](#%E4%B9%9D-%E5%BC%82%E6%AD%A5%E6%94%AF%E6%8C%81asynchrony-support)
    - [å¤„ç† Future](#%E5%A4%84%E7%90%86-future)
    - [å£°æ˜å¼‚æ­¥å‡½æ•°](#%E5%A3%B0%E6%98%8E%E5%BC%82%E6%AD%A5%E5%87%BD%E6%95%B0)
    - [å¤„ç† Stream](#%E5%A4%84%E7%90%86-stream)
- [(å) å…¶ä»–](#%E5%8D%81-%E5%85%B6%E4%BB%96)
  - [ç”Ÿæˆå™¨](#%E7%94%9F%E6%88%90%E5%99%A8)
  - [å¯è°ƒç”¨ç±»](#%E5%8F%AF%E8%B0%83%E7%94%A8%E7%B1%BB)
  - [éš”ç¦»åŒº](#%E9%9A%94%E7%A6%BB%E5%8C%BA)
  - [Typedefs](#typedefs)
  - [å…ƒæ•°æ®](#%E5%85%83%E6%95%B0%E6%8D%AE)
  - [æ³¨é‡Š](#%E6%B3%A8%E9%87%8A)

<!-- END doctoc generated TOC please keep comment here to allow auto update -->

---

å®˜æ–¹[Dart å¼€å‘è¯­è¨€æ¦‚è§ˆ](https://dart.cn/guides/language/language-tour)çš„ç¬”è®°

# (ã€‡)é‡è¦æ¦‚å¿µ

å­¦ä¹  Dart è¯­è¨€æ—¶, åº”è¯¥ç‰¢è®°ä»¥ä¸‹å‡ ç‚¹

- æ‰€æœ‰å˜é‡å¼•ç”¨çš„éƒ½æ˜¯ **å¯¹è±¡**ï¼Œæ¯ä¸ªå¯¹è±¡éƒ½æ˜¯ä¸€ä¸ª **ç±»** çš„å®ä¾‹ã€‚
  - æ•°å­—ã€å‡½æ•°ä»¥åŠ null éƒ½æ˜¯å¯¹è±¡ã€‚é™¤å» null ä»¥å¤–ï¼ˆå¦‚æœä½ å¼€å¯äº† _ç©ºå®‰å…¨(Null safety)_ï¼‰, æ‰€æœ‰çš„ç±»éƒ½ç»§æ‰¿äº Object ç±»ã€‚
- å°½ç®¡ Dart æ˜¯å¼ºç±»å‹è¯­è¨€ï¼Œä½†æ˜¯åœ¨å£°æ˜å˜é‡æ—¶æŒ‡å®šç±»å‹æ˜¯å¯é€‰çš„ï¼Œå› ä¸º Dart å¯ä»¥è¿›è¡Œç±»å‹æ¨æ–­ã€‚
- å¦‚æœä½ å¼€å¯äº† _ç©ºå®‰å…¨_ï¼Œå˜é‡åœ¨æœªå£°æ˜ä¸ºå¯ç©ºç±»å‹æ—¶ä¸èƒ½ä¸º nullã€‚
  - ä½ å¯ä»¥é€šè¿‡åœ¨ç±»å‹ååŠ ä¸Šé—®å· (`?`) å°†ç±»å‹å£°æ˜ä¸ºå¯ç©ºã€‚
    ä¾‹å¦‚ï¼Œint? ç±»å‹çš„å˜é‡å¯ä»¥æ˜¯æ•´å½¢æ•°å­—æˆ– nullã€‚
  - å¦‚æœä½  **æ˜ç¡®çŸ¥é“** ä¸€ä¸ªè¡¨è¾¾å¼ä¸ä¼šä¸ºç©ºï¼Œä½† Dart ä¸è¿™ä¹ˆè®¤ä¸ºæ—¶ï¼Œä½ å¯ä»¥åœ¨è¡¨è¾¾å¼åæ·»åŠ  `!` æ¥æ–­è¨€è¡¨è¾¾å¼ä¸ä¸ºç©ºï¼ˆä¸ºç©ºæ—¶å°†æŠ›å‡ºå¼‚å¸¸ï¼‰ã€‚
    ä¾‹å¦‚ï¼š`int x = nullableButNotNullInt!`
- å¦‚æœä½ æƒ³è¦æ˜¾å¼åœ°å£°æ˜å…è®¸ä»»æ„ç±»å‹ï¼Œä½¿ç”¨ `Object?`ï¼ˆå¦‚æœä½  å¼€å¯äº†ç©ºå®‰å…¨ï¼‰ã€ `Object` æˆ–è€… `ç‰¹æ®Šç±»å‹ dynamic` å°†æ£€æŸ¥å»¶è¿Ÿåˆ°è¿è¡Œæ—¶è¿›è¡Œã€‚
- Dart æ”¯æŒæ³›å‹
  - æ¯”å¦‚ `List<int>`ï¼ˆè¡¨ç¤ºä¸€ç»„ç”± int å¯¹è±¡ç»„æˆçš„åˆ—è¡¨ï¼‰æˆ– `List<Object>`ï¼ˆè¡¨ç¤ºä¸€ç»„ç”±ä»»ä½•ç±»å‹å¯¹è±¡ç»„æˆçš„åˆ—è¡¨ï¼‰ã€‚
- Dart æ”¯æŒ**é¡¶çº§å‡½æ•°**ï¼ˆä¾‹å¦‚ main æ–¹æ³•ï¼‰ï¼ŒåŒæ—¶è¿˜æ”¯æŒå®šä¹‰å±äºç±»æˆ–å¯¹è±¡çš„å‡½æ•°ï¼ˆå³ é™æ€ å’Œ å®ä¾‹æ–¹æ³•ï¼‰ã€‚ä½ è¿˜å¯ä»¥åœ¨å‡½æ•°ä¸­å®šä¹‰å‡½æ•°ï¼ˆåµŒå¥— æˆ– å±€éƒ¨å‡½æ•°ï¼‰ã€‚
- Dart æ”¯æŒ**é¡¶çº§å˜é‡**ï¼Œä»¥åŠå®šä¹‰å±äºç±»æˆ–å¯¹è±¡çš„å˜é‡ï¼ˆé™æ€å’Œå®ä¾‹å˜é‡ï¼‰ã€‚å®ä¾‹å˜é‡æœ‰æ—¶ç§°ä¹‹ä¸ºåŸŸæˆ–å±æ€§ã€‚
- Dart **æ²¡æœ‰**ç±»ä¼¼äº Java é‚£æ ·çš„ publicã€protected å’Œ private æˆå‘˜è®¿é—®é™å®šç¬¦ã€‚
  - å¦‚æœä¸€ä¸ªæ ‡è¯†ç¬¦ä»¥ä¸‹åˆ’çº¿ (`_`) å¼€å¤´åˆ™è¡¨ç¤ºè¯¥æ ‡è¯†ç¬¦*åœ¨åº“å†…æ˜¯ç§æœ‰çš„*ã€‚
- _æ ‡è¯†ç¬¦_ å¯ä»¥ä»¥å­—æ¯æˆ–è€…ä¸‹åˆ’çº¿ (`_`) å¼€å¤´ï¼Œå…¶åå¯è·Ÿå­—ç¬¦å’Œæ•°å­—çš„ç»„åˆã€‚
- Dart ä¸­ **è¡¨è¾¾å¼** å’Œ **è¯­å¥** æ˜¯æœ‰åŒºåˆ«çš„ï¼Œ**è¡¨è¾¾å¼æœ‰å€¼è€Œè¯­å¥æ²¡æœ‰ã€‚**
  - æ¯”å¦‚æ¡ä»¶è¡¨è¾¾å¼ `expression condition ? expr1 : expr2` ä¸­å«æœ‰å€¼ expr1 æˆ– expr2ã€‚
  - ä¸ if-else åˆ†æ”¯è¯­å¥ç›¸æ¯”ï¼Œif-else åˆ†æ”¯è¯­å¥åˆ™æ²¡æœ‰å€¼ã€‚
  - _ä¸€ä¸ªè¯­å¥é€šå¸¸åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªè¡¨è¾¾å¼ï¼Œä½†æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ä¸èƒ½åªåŒ…å«ä¸€ä¸ªè¯­å¥_ã€‚
- Dart å·¥å…·å¯ä»¥æ˜¾ç¤º **è­¦å‘Š** å’Œ **é”™è¯¯** ä¸¤ç§ç±»å‹çš„é—®é¢˜ã€‚
  - è­¦å‘Šè¡¨æ˜ä»£ç å¯èƒ½æœ‰é—®é¢˜ä½†ä¸ä¼šé˜»æ­¢å…¶è¿è¡Œã€‚
  - é”™è¯¯åˆ†ä¸ºç¼–è¯‘æ—¶é”™è¯¯å’Œè¿è¡Œæ—¶é”™è¯¯ï¼›
    - ç¼–è¯‘æ—¶é”™è¯¯ä»£ç æ— æ³•è¿è¡Œï¼›
    - è¿è¡Œæ—¶é”™è¯¯ä¼šåœ¨ä»£ç è¿è¡Œæ—¶å¯¼è‡´*å¼‚å¸¸*ã€‚

# (ä¸€) å˜é‡

## 1 å˜é‡åŸºç¡€

- è™½ç„¶ Dart æ˜¯ä»£ç ç±»å‹å®‰å…¨çš„è¯­è¨€ï¼Œä½†æ˜¯ç”±äºå…¶æ”¯æŒç±»å‹æ¨æ–­ï¼Œå› æ­¤å¤§å¤šæ•°å˜é‡ä¸éœ€è¦æ˜¾å¼åœ°æŒ‡å®šç±»å‹ã€‚
- å˜é‡ä»…å­˜å‚¨å¯¹è±¡çš„å¼•ç”¨ã€‚
- é€šè¿‡ var å£°æ˜å±€éƒ¨å˜é‡è€Œéä½¿ç”¨æŒ‡å®šçš„ç±»å‹ã€‚

```dart
/*
  - è¿™é‡Œåä¸º name çš„å˜é‡å­˜å‚¨äº†ä¸€ä¸ª String ç±»å‹å¯¹è±¡çš„å¼•ç”¨ï¼Œâ€œBobâ€ åˆ™æ˜¯è¯¥å¯¹è±¡çš„å€¼ã€‚
  - name å˜é‡çš„ç±»å‹è¢«æ¨æ–­ä¸º Stringï¼Œä½†æ˜¯ä½ å¯ä»¥ä¸ºå…¶æŒ‡å®šç±»å‹ã€‚
  - å¦‚æœä¸€ä¸ªå¯¹è±¡çš„å¼•ç”¨ä¸å±€é™äºå•ä¸€çš„ç±»å‹ï¼Œå¯ä»¥å°†å…¶æŒ‡å®šä¸º Objectï¼ˆæˆ– dynamicï¼‰ç±»å‹ã€‚
  */
var name = 'Bob';
Object name = 'Bob';
String name = 'Bob';

var year = 1977;
var antennaDiameter = 3.7;
var flybyObjects = ['Jupiter', 'Saturn', 'Uranus', 'Neptune'];
var image = {
  'tags': ['saturn'],
  'url': '//path/to/saturn.jpg'
};
```

### é»˜è®¤å€¼

- åœ¨ Dart ä¸­ï¼Œæœªåˆå§‹åŒ–ä»¥åŠå¯ç©ºç±»å‹çš„å˜é‡æ‹¥æœ‰ä¸€ä¸ªé»˜è®¤çš„åˆå§‹å€¼ nullã€‚ï¼ˆå¦‚æœä½ æœªè¿ç§»è‡³ ç©ºå®‰å…¨ï¼Œæ‰€æœ‰å˜é‡éƒ½ä¸ºå¯ç©ºç±»å‹ã€‚ï¼‰å³ä¾¿æ•°å­—ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œå› ä¸ºåœ¨ Dart ä¸­ä¸€åˆ‡çš†ä¸ºå¯¹è±¡ï¼Œæ•°å­—ä¹Ÿä¸ä¾‹å¤–ã€‚
- å¦‚æœå¯ç”¨ null å®‰å…¨æ€§ï¼Œåˆ™å¿…é¡»åœ¨ä½¿ç”¨ä¸å¯ä¸º null çš„å˜é‡ä¹‹å‰åˆå§‹åŒ–å®ƒä»¬çš„å€¼ã€‚
- assert() çš„è°ƒç”¨å°†ä¼šåœ¨ç”Ÿäº§ç¯å¢ƒçš„ä»£ç ä¸­è¢«å¿½ç•¥æ‰ã€‚åœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œassert(condition) å°†ä¼šåœ¨ æ¡ä»¶åˆ¤æ–­ ä¸º false æ—¶æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ã€‚

```dart
int? lineCount;
assert(lineCount == null);
int lineCount = 0 ;
```

### late å˜é‡

ä½œç”¨ï¼š

- å£°æ˜ä¸€ä¸ªä¸å¯ä¸ºç©ºçš„å˜é‡ï¼Œå¹¶åœ¨å£°æ˜åè¢«åˆå§‹åŒ–ã€‚
- æ‡’æƒ°(lazy)åœ°åˆå§‹åŒ–ä¸€ä¸ªå˜é‡ã€‚

```dart
late String description;
```

### Final å’Œ Const

- å¦‚æœä½ ä¸æƒ³æ›´æ”¹ä¸€ä¸ªå˜é‡ï¼Œå¯ä»¥ä½¿ç”¨å…³é”®å­— final æˆ–è€… const ä¿®é¥°å˜é‡ï¼Œ
  - è¿™ä¸¤ä¸ªå…³é”®å­—å¯ä»¥æ›¿ä»£ var å…³é”®å­—æˆ–è€…åŠ åœ¨ä¸€ä¸ªå…·ä½“çš„ç±»å‹å‰ã€‚
- ä¸€ä¸ª final å˜é‡åªå¯ä»¥è¢«èµ‹å€¼ä¸€æ¬¡ï¼›ä¸€ä¸ª const å˜é‡æ˜¯ä¸€ä¸ªç¼–è¯‘æ—¶å¸¸é‡ï¼ˆconst å˜é‡åŒæ—¶ä¹Ÿæ˜¯ final çš„ï¼‰ã€‚
- é¡¶å±‚çš„ final å˜é‡æˆ–è€…ç±»çš„ final å˜é‡åœ¨å…¶ç¬¬ä¸€æ¬¡ä½¿ç”¨çš„æ—¶å€™è¢«åˆå§‹åŒ–ã€‚
- noteï¼š å®ä¾‹å˜é‡ å¯ä»¥æ˜¯ final çš„ä½†ä¸å¯ä»¥æ˜¯ constã€‚
- ä¸èƒ½ä¿®æ”¹ä¸€ä¸ª final å˜é‡çš„å€¼ã€‚
- ä½¿ç”¨å…³é”®å­— const ä¿®é¥°å˜é‡è¡¨ç¤ºè¯¥å˜é‡ä¸º ç¼–è¯‘æ—¶å¸¸é‡ã€‚
  - å¦‚æœä½¿ç”¨ const ä¿®é¥°ç±»ä¸­çš„å˜é‡ï¼Œåˆ™å¿…é¡»åŠ ä¸Š static å…³é”®å­—ï¼Œå³ static constï¼ˆè¯‘è€…æ³¨ï¼šé¡ºåºä¸èƒ½é¢ å€’ï¼‰
- const å…³é”®å­—ä¸ä»…ä»…å¯ä»¥ç”¨æ¥å®šä¹‰å¸¸é‡ï¼Œè¿˜å¯ä»¥ç”¨æ¥åˆ›å»º å¸¸é‡å€¼ï¼Œè¯¥å¸¸é‡å€¼å¯ä»¥èµ‹äºˆç»™ä»»ä½•å˜é‡ã€‚
- å¸¸é‡çš„å€¼ä¸å¯ä»¥è¢«ä¿®æ”¹ã€‚

```dart
final bname = 'Bob'; // Without a type annotation
final String nickname = 'Bobby';

// å¦‚æœä½¿ç”¨åˆå§‹åŒ–è¡¨è¾¾å¼ä¸ºå¸¸é‡èµ‹å€¼å¯ä»¥çœç•¥æ‰å…³é”®å­— const
const baz = []; // Equivalent to `const baz = const []`

// æ²¡æœ‰ä½¿ç”¨ final æˆ– const ä¿®é¥°çš„å˜é‡çš„å€¼æ˜¯å¯ä»¥è¢«æ›´æ”¹çš„ï¼Œå³ä½¿è¿™äº›å˜é‡ä¹‹å‰å¼•ç”¨è¿‡ const çš„å€¼ã€‚
var foo = const [];

// ä½ å¯ä»¥åœ¨å¸¸é‡ä¸­ä½¿ç”¨ ç±»å‹æ£€æŸ¥å’Œå¼ºåˆ¶ç±»å‹è½¬æ¢ (is å’Œ as)ã€ é›†åˆä¸­çš„ if ä»¥åŠ å±•å¼€æ“ä½œç¬¦ (... å’Œ ...?)ï¼š
const Object i = 3; // Where i is a const Object with an int value...
const list = [i as int]; // Use a typecast.
const map = {if (i is int) i: 'int'}; // Use is and collection if.
const set = {if (list is List<int>) ...list}; // ...and a spread.

void main() {
  print('Hello, World!');
  print('å˜é‡ï¼š image is ${image}');
  print('å˜é‡ï¼š lineCount is ${lineCount}'); // å˜é‡ï¼š lineCount is null

  description = 'å…ˆå£°æ˜äº†è¿™ä¸ªå˜é‡ï¼Œä½†åœ¨ä½¿ç”¨çš„æ—¶å€™æ‰ç»™çš„å€¼ã€‚';
  print(description);

  foo = [1, 2, 3]; // ä¹‹å‰æ˜¯ const []ï¼Œä½†å› ä¸ºä¸æ˜¯ä½¿ç”¨finalæˆ–è€…constå£°æ˜ï¼Œåªæ˜¯å€¼ä¸ºconstï¼Œæ‰€ä»¥å¯ä»¥ä¿®æ”¹å€¼
  print(foo); // [1, 2, 3]

  print(i); // 3
  print(list); // [3]
  print(map); // {3:int}
  print(set); // {3}
}
```

## notes

- 1 å˜é‡ä»…å­˜å‚¨å¯¹è±¡çš„å¼•ç”¨ã€‚å˜é‡å¯ä»¥è‡ªåŠ¨æ¨æ–­ï¼Œä¸€èˆ¬ä¸éœ€è¦æŒ‡å®šç±»å‹ã€‚å¦‚æœå˜é‡ä¸å±€é™ä¸ä¸€ç§ç±»å‹ï¼Œå¯å£°æ˜ä¸º Object æˆ–è€… dynamic ç±»å‹ã€‚
- 2 **dart ä¸­ä¸€åˆ‡çš†ä¸ºå¯¹è±¡ã€‚æœªåˆå§‹åŒ–ä»¥åŠå¯ç©ºç±»å‹çš„å˜é‡æ‹¥æœ‰ä¸€ä¸ªé»˜è®¤çš„åˆå§‹å€¼ null**ã€‚
- 3 å¦‚æœæœ‰å…ˆå£°æ˜å˜é‡ï¼Œlazy åœ°åˆå§‹åŒ–ï¼Œæˆ–è€…åˆå§‹åŒ–å˜é‡æˆæœ¬è¾ƒé«˜åœ°æ—¶å€™ï¼Œå¯ä»¥ä½¿ç”¨ late ä¿®é¥°å˜é‡ã€‚
- 4 final ä¿®é¥°çš„å˜é‡ä¸å¯ä¿®æ”¹ï¼Œ const ä¿®é¥°çš„æ˜¯ä¸€ä¸ªç¼–è¯‘æ—¶å¸¸é‡ã€‚const å˜é‡åŒæ—¶ä¹Ÿæ˜¯ finalã€‚
- 4.1 å¯ä»¥åœ¨å¸¸é‡ä¸­ä½¿ç”¨ç±»å‹æ£€æŸ¥ï¼ˆisï¼‰å’Œç±»å‹è½¬æ¢ï¼ˆasï¼‰ï¼Œåœ¨å¸¸é‡é›†åˆï¼ˆSetï¼‰ä¸­ä½¿ç”¨é›†åˆä¸­çš„ if ä»¥åŠ å±•å¼€æ“ä½œç¬¦ã€‚

# (äºŒ)å†…ç½®ç±»å‹

## Dart è¯­è¨€æ”¯æŒä¸‹åˆ—å†…å®¹

- Numbers (int, double)
- Strings (String)
- Booleans (bool)
- Lists (ä¹Ÿè¢«ç§°ä¸º arrays)
- Sets (Set)
- Maps (Map)
- Runes (å¸¸ç”¨äºåœ¨ Characters API ä¸­è¿›è¡Œå­—ç¬¦æ›¿æ¢)
- Symbols (Symbol)
- null (Null)

å…¶ä»–ä¸€äº›ç±»å‹åœ¨ Dart è¯­è¨€ä¸­ä¹Ÿæœ‰ç‰¹æ®Šçš„ä½œç”¨ã€‚

- `Object`ï¼šæ‰€æœ‰ Dart ç±»çš„è¶…ç±»ï¼Œé™¤äº† Nullã€‚
- `Future` å’Œ `Stream`ï¼šåœ¨å¼‚æ­¥æ”¯æŒä¸­ä½¿ç”¨ã€‚
- `Iterable`ï¼šåœ¨ for-in å¾ªç¯å’ŒåŒæ­¥ç”Ÿæˆå™¨å‡½æ•°ä¸­ä½¿ç”¨ã€‚
- `Never`ï¼šè¡¨ç¤ºä¸€ä¸ªè¡¨è¾¾å¼æ°¸è¿œæ— æ³•æˆåŠŸå®Œæˆè¯„ä¼°ã€‚æœ€å¸¸ç”¨äºæ€»æ˜¯æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸çš„å‡½æ•°ã€‚
- `dynamic`ï¼šè¡¨ç¤ºä½ æƒ³ç¦ç”¨é™æ€æ£€æŸ¥ã€‚é€šå¸¸ä½ åº”è¯¥ä½¿ç”¨ Object æˆ– Object?ä»£æ›¿ã€‚
- `void`ï¼šè¡¨ç¤ºä¸€ä¸ªå€¼æ°¸è¿œä¸ä¼šè¢«ä½¿ç”¨ã€‚é€šå¸¸ä½œä¸ºè¿”å›ç±»å‹ä½¿ç”¨ã€‚

`Object`ã€`Object?`ã€`Null` å’Œ `Never` ç±»åœ¨ç±»çš„å±‚æ¬¡ç»“æ„ä¸­å…·æœ‰ç‰¹æ®Šçš„ä½œç”¨ï¼Œæ­£å¦‚åœ¨ç†è§£ null å®‰å…¨çš„ä¸Šä¸‹æ–‡ä¸­æ‰€æè¿°çš„ã€‚

## Numbers

- `int`ï¼šæ•´æ•°å€¼ï¼›é•¿åº¦ä¸è¶…è¿‡ 64 ä½ï¼Œå…·ä½“å–å€¼èŒƒå›´ ä¾èµ–äºä¸åŒçš„å¹³å°ã€‚
- `double`ï¼š64 ä½çš„åŒç²¾åº¦æµ®ç‚¹æ•°å­—ï¼Œä¸”ç¬¦åˆ IEEE 754 æ ‡å‡†ã€‚
- int å’Œ double éƒ½æ˜¯ `num` çš„å­ç±»ã€‚
  - num ä¸­å®šä¹‰äº†ä¸€äº›åŸºæœ¬çš„è¿ç®—ç¬¦(+ - \* / ç­‰ç­‰)
  - å¦‚æœ num åŠå…¶å­ç±»ä¸æ»¡è¶³ä½ çš„è¦æ±‚ï¼Œå¯ä»¥æŸ¥çœ‹ `dart:math` åº“ä¸­çš„ API

## Strings

Dart å­—ç¬¦ä¸²ï¼ˆString å¯¹è±¡ï¼‰åŒ…å«äº† UTF-16 ç¼–ç çš„å­—ç¬¦åºåˆ—ã€‚

- å¯ä»¥ä½¿ç”¨å•å¼•å·æˆ–è€…åŒå¼•å·æ¥åˆ›å»ºå­—ç¬¦ä¸²ã€‚
- ä½¿ç”¨ä¸‰ä¸ªå•å¼•å·æˆ–è€…ä¸‰ä¸ªåŒå¼•å·ä¹Ÿèƒ½åˆ›å»ºå¤šè¡Œå­—ç¬¦ä¸²
- **åœ¨å­—ç¬¦ä¸²ä¸­ï¼Œè¯·ä»¥ `${è¡¨è¾¾å¼}` çš„å½¢å¼ä½¿ç”¨è¡¨è¾¾å¼ï¼Œå¦‚æœè¡¨è¾¾å¼æ˜¯ä¸€ä¸ªæ ‡è¯†ç¬¦ï¼Œå¯ä»¥çœç•¥æ‰ `{}`**ã€‚
- å¦‚æœè¡¨è¾¾å¼çš„ç»“æœä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œåˆ™ Dart ä¼šè°ƒç”¨è¯¥å¯¹è±¡çš„ toString æ–¹æ³•æ¥è·å–ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚
- `==` è¿ç®—ç¬¦è´Ÿè´£åˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡çš„å†…å®¹æ˜¯å¦ä¸€æ ·ï¼Œå¦‚æœä¸¤ä¸ªå­—ç¬¦ä¸²åŒ…å«ä¸€æ ·çš„å­—ç¬¦ç¼–ç åºåˆ—ï¼Œåˆ™è¡¨ç¤ºç›¸ç­‰ã€‚
- åœ¨å­—ç¬¦ä¸²å‰åŠ ä¸Š `r` ä½œä¸ºå‰ç¼€åˆ›å»º â€œrawâ€ å­—ç¬¦ä¸²ï¼ˆå³ä¸ä¼šè¢«åšä»»ä½•å¤„ç†ï¼ˆæ¯”å¦‚è½¬ä¹‰ï¼‰çš„å­—ç¬¦ä¸²ï¼‰
- å­—ç¬¦ä¸²å­—é¢é‡æ˜¯ä¸€ä¸ªç¼–è¯‘æ—¶å¸¸é‡ï¼Œåªè¦æ˜¯ç¼–è¯‘æ—¶å¸¸é‡ (è‡ªæ³¨ï¼šconst çš„éå¼•ç”¨ç±»å‹ï¼Ÿ)(nullã€æ•°å­—ã€å­—ç¬¦ä¸²ã€å¸ƒå°”) éƒ½å¯ä»¥ä½œä¸ºå­—ç¬¦ä¸²å­—é¢é‡çš„æ’å€¼è¡¨è¾¾å¼

## å¸ƒå°”ç±»å‹

Dart ä½¿ç”¨ bool å…³é”®å­—è¡¨ç¤ºå¸ƒå°”ç±»å‹ï¼Œå¸ƒå°”ç±»å‹åªæœ‰ä¸¤ä¸ªå¯¹è±¡ `true` å’Œ `false`ï¼Œä¸¤è€…éƒ½æ˜¯ç¼–è¯‘æ—¶å¸¸é‡ã€‚

Dart çš„ç±»å‹å®‰å…¨ä¸å…è®¸ä½ ä½¿ç”¨ç±»ä¼¼` if (nonbooleanValue)` æˆ–è€… `assert (nonbooleanValue)` è¿™æ ·çš„ä»£ç æ£€æŸ¥å¸ƒå°”å€¼ã€‚ç›¸åï¼Œä½ åº”è¯¥æ€»æ˜¯æ˜¾ç¤ºåœ°æ£€æŸ¥å¸ƒå°”å€¼ï¼Œæ¯”å¦‚åƒä¸‹é¢çš„ä»£ç è¿™æ ·ï¼š

```dart
// Check for an empty string.
var fullName = '';
assert(fullName.isEmpty);

// Check for zero.
var hitPoints = 0;
assert(hitPoints <= 0);

// Check for null.
var unicorn;
assert(unicorn == null);

// Check for NaN.
var iMeantToDoThis = 0 / 0;
assert(iMeantToDoThis.isNaN);
```

## Lists

æ•°ç»„ (Array) æ˜¯å‡ ä¹æ‰€æœ‰ç¼–ç¨‹è¯­è¨€ä¸­æœ€å¸¸è§çš„é›†åˆç±»å‹ï¼Œåœ¨ Dart ä¸­æ•°ç»„ç”± List å¯¹è±¡è¡¨ç¤ºã€‚é€šå¸¸ç§°ä¹‹ä¸º Listã€‚

- List çš„ä¸‹æ ‡ç´¢å¼•ä» 0 å¼€å§‹ï¼Œç¬¬ä¸€ä¸ªå…ƒç´ çš„ä¸‹æ ‡ä¸º 0ï¼Œæœ€åä¸€ä¸ªå…ƒç´ çš„ä¸‹æ ‡ä¸º `list.length - 1`ã€‚
- åœ¨ List å­—é¢é‡å‰æ·»åŠ  const å…³é”®å­—ä¼šåˆ›å»ºä¸€ä¸ªç¼–è¯‘æ—¶å¸¸é‡
- Dart åœ¨ 2.3 å¼•å…¥äº† æ‰©å±•æ“ä½œç¬¦ï¼ˆ`...`ï¼‰å’Œ ç©ºæ„ŸçŸ¥æ‰©å±•æ“ä½œç¬¦ï¼ˆ`...?`ï¼‰ï¼Œå®ƒä»¬æä¾›äº†ä¸€ç§å°†å¤šä¸ªå…ƒç´ æ’å…¥é›†åˆçš„ç®€æ´æ–¹æ³•ã€‚

```dart
var list = [1, 2, 3];
// è¿™é‡Œ Dart æ¨æ–­å‡º list çš„ç±»å‹ä¸º List<int>ï¼Œå¦‚æœå¾€è¯¥æ•°ç»„ä¸­æ·»åŠ ä¸€ä¸ªé int ç±»å‹çš„å¯¹è±¡åˆ™ä¼šæŠ¥é”™ã€‚
list.add("5"); // The argument type 'String' can't be assigned to the parameter type 'int'

// var list2 = [1, 2, 3, '4']; // List<Object>
var list3 = [0, ...list];
assert(list3.length == 4);  // list3ç¾åœ¨ä¸º[0,1,2,3]

// å¦‚æœæ‰©å±•æ“ä½œç¬¦å³è¾¹å¯èƒ½ä¸º null ï¼Œä½ å¯ä»¥ä½¿ç”¨ null-aware æ‰©å±•æ“ä½œç¬¦ï¼ˆ...?ï¼‰æ¥é¿å…äº§ç”Ÿå¼‚å¸¸ï¼š
var list4;
var list5=[0,...?list4];  // [0]
```

- Dart è¿˜åŒæ—¶å¼•å…¥äº†**é›†åˆä¸­çš„ if** å’Œ **é›†åˆä¸­çš„ for** æ“ä½œï¼Œåœ¨**æ„å»ºé›†åˆ**æ—¶ï¼Œå¯ä»¥ä½¿ç”¨æ¡ä»¶åˆ¤æ–­ (if) å’Œå¾ªç¯ (for)ã€‚

```dart
// é›†åˆä¸­çš„ if æ¥åˆ›å»ºä¸€ä¸ª List çš„ç¤ºä¾‹ï¼Œå®ƒå¯èƒ½åŒ…å« 3 ä¸ªæˆ– 4 ä¸ªå…ƒç´ 
var nav = [
  'Home',
  'Furniture',
  'Plants',
  if (promoActive) 'Outlet'
];

// é›†åˆä¸­çš„ for å°†åˆ—è¡¨ä¸­çš„å…ƒç´ ä¿®æ”¹åæ·»åŠ åˆ°å¦ä¸€ä¸ªåˆ—è¡¨ä¸­çš„ç¤ºä¾‹
  var listOfInts = [1, 2, 3];
  var listOfStrings = ['#0', for (var i in listOfInts) '#$i'];
  print(listOfStrings); // [#0, #1, #2, #3]

```

_List ç±»ä¸­æœ‰è®¸å¤šç”¨äºæ“ä½œ List çš„ä¾¿æ·æ–¹æ³•ï¼Œä½ å¯ä»¥æŸ¥é˜… `æ³›å‹Generics` å’Œ `é›†åˆCollections` è·å–æ›´å¤šä¸ä¹‹ç›¸å…³çš„ä¿¡æ¯ã€‚_

æ›´å¤šæŸ¥çœ‹[List API](https://api.dart.cn/stable/2.16.2/dart-core/List-class.html)

## Sets

åœ¨ Dart ä¸­ï¼Œset æ˜¯ä¸€ç»„**ç‰¹å®šå…ƒç´ çš„æ— åºé›†åˆ**ã€‚ Dart æ”¯æŒçš„é›†åˆç”±`é›†åˆçš„å­—é¢é‡(set literals)`å’Œ Set ç±»æä¾›ã€‚

_å°½ç®¡ **Set ç±»å‹(type)** ä¸€ç›´éƒ½æ˜¯ Dart çš„ä¸€é¡¹æ ¸å¿ƒåŠŸèƒ½ï¼Œä½†æ˜¯ **Set å­—é¢é‡(literals)** æ˜¯åœ¨ Dart 2.2 ä¸­æ‰åŠ å…¥çš„ã€‚_

```dart
// ä½¿ç”¨ Set å­—é¢é‡æ¥åˆ›å»ºä¸€ä¸ª Set é›†åˆçš„æ–¹æ³•ï¼š
var halogens = {'fluorine', 'chlorine', 'bromine', 'iodine', 'astatine'};

// åˆ›å»ºç©ºçš„set
var names = <String>{};
// Set<String> names = {}; // This works, too.
// var names = {}; // Creates a map, not a set. å› ä¸ºå…ˆæœ‰çš„ Map å­—é¢é‡è¯­æ³•ï¼Œæ‰€ä»¥ {} é»˜è®¤æ˜¯ Map ç±»å‹ã€‚
```

**ä» Dart 2.3 å¼€å§‹ï¼ŒSet å¯ä»¥åƒ List ä¸€æ ·æ”¯æŒä½¿ç”¨æ‰©å±•æ“ä½œç¬¦ï¼ˆ`...` å’Œ `...?`ï¼‰ä»¥åŠ é›†åˆä¸­ `if` å’Œ `for` æ“ä½œã€‚**

- ä½¿ç”¨ `add()` æ–¹æ³•æˆ– `addAll()` æ–¹æ³•å‘å·²å­˜åœ¨çš„ Set ä¸­æ·»åŠ é¡¹ç›®ã€‚
- ä½¿ç”¨ `.length` å¯ä»¥è·å– Set ä¸­å…ƒç´ çš„æ•°é‡ã€‚
- å¯ä»¥åœ¨ Set å˜é‡å‰æ·»åŠ  const å…³é”®å­—åˆ›å»ºä¸€ä¸ª Set ç¼–è¯‘æ—¶å¸¸é‡ã€‚

æ›´å¤šæŸ¥çœ‹[Set API](https://api.dart.cn/stable/2.16.2/dart-core/Set-class.html)

```dart
final constantSet = const {
  'fluorine',
  'chlorine',
  'bromine',
  'iodine',
  'astatine',
};
// constantSet.add('helium'); // This line will cause an error.
```

## Maps

- é€šå¸¸æ¥è¯´ï¼ŒMap æ˜¯ç”¨æ¥å…³è” keys å’Œ values çš„å¯¹è±¡ã€‚å…¶ä¸­é”®å’Œå€¼éƒ½å¯ä»¥æ˜¯ä»»ä½•ç±»å‹çš„å¯¹è±¡ã€‚
- æ¯ä¸ª `key(é”®)` åªèƒ½å‡ºç°ä¸€æ¬¡ä½†æ˜¯ `value(å€¼)` å¯ä»¥é‡å¤å‡ºç°å¤šæ¬¡ã€‚
- Dart ä¸­ Map æä¾›äº† Map å­—é¢é‡ä»¥åŠ Map ç±»å‹ä¸¤ç§å½¢å¼çš„ Mapã€‚

**ä½¿ç”¨ Map å­—é¢é‡åˆ›å»º Mapï¼š**

```dart
// Dart å°† gifts å˜é‡çš„ç±»å‹æ¨æ–­ä¸º Map<String, String>ï¼Œè€Œå°† nobleGases çš„ç±»å‹æ¨æ–­ä¸º Map<int, String>ã€‚
// å¦‚æœä½ å‘è¿™ä¸¤ä¸ª Map å¯¹è±¡ä¸­æ·»åŠ ä¸æ­£ç¡®çš„ç±»å‹å€¼ï¼Œå°†å¯¼è‡´è¿è¡Œæ—¶å¼‚å¸¸ã€‚
var gifts = {
  // Key:    Value
  'first': 'partridge',
  'second': 'turtledoves',
  'fifth': 'golden rings'
};

var nobleGases = {
  2: 'helium',
  10: 'neon',
  18: 'argon',
};
```

**ä¹Ÿå¯ä»¥ä½¿ç”¨ Map çš„æ„é€ å™¨åˆ›å»º Mapï¼š**

- _ä¹Ÿè®¸ä½ æƒ³ä½¿ç”¨ `new Map()` æ„é€  Map å¯¹è±¡ã€‚ä½†æ˜¯åœ¨ Dart ä¸­ï¼Œ`new` å…³é”®è¯æ˜¯å¯é€‰çš„ã€‚(è¯‘è€…æ³¨ï¼šä¸”ä¸è¢«å»ºè®®ä½¿ç”¨)_

```dart
// åœ¨ Dart ä¸­ï¼Œnew å…³é”®è¯æ˜¯å¯é€‰çš„ï¼Œä¸”ä¸è¢«å»ºè®®ä½¿ç”¨ã€‚
var gifts = Map<String, String>();
gifts['first'] = 'partridge';
gifts['second'] = 'turtledoves';
gifts['fifth'] = 'golden rings';

var nobleGases = Map<int, String>();
nobleGases[2] = 'helium';
nobleGases[10] = 'neon';
nobleGases[18] = 'argon';
```

åœ¨ä¸€ä¸ª Map å­—é¢é‡å‰æ·»åŠ  const å…³é”®å­—å¯ä»¥åˆ›å»ºä¸€ä¸ª Map ç¼–è¯‘æ—¶å¸¸é‡ï¼š

```dart
final constantMap = const {
  2: 'helium',
  10: 'neon',
  18: 'argon',
};

// constantMap[2] = 'Helium'; // This line will cause an error.
```

Map å¯ä»¥åƒ List ä¸€æ ·æ”¯æŒä½¿ç”¨æ‰©å±•æ“ä½œç¬¦ï¼ˆ`...` å’Œ `...?`ï¼‰ä»¥åŠé›†åˆçš„ `if` å’Œ `for` æ“ä½œã€‚

**listã€setã€map çš„è®¸å¤šæ“ä½œå’Œ js ä¸­çš„ç±»ä¼¼**

## Runes ä¸ grapheme clusters

åœ¨ Dart ä¸­ï¼Œ`runes` å…¬å¼€äº†å­—ç¬¦ä¸²çš„ Unicode ç ä½ã€‚ä½¿ç”¨ `characters` åŒ… æ¥è®¿é—®æˆ–è€…æ“ä½œç”¨æˆ·æ„ŸçŸ¥çš„å­—ç¬¦ï¼Œä¹Ÿè¢«ç§°ä¸º Unicode (æ‰©å±•) `grapheme clusters`ã€‚

```dart
import 'package:characters/characters.dart';
...
var hi = 'Hi ğŸ‡©ğŸ‡°';
print(hi);
print('The end of the string: ${hi.substring(hi.length - 1)}');
print('The last character: ${hi.characters.last}\n');
```

## Symbols

Symbol è¡¨ç¤º Dart ä¸­å£°æ˜çš„æ“ä½œç¬¦æˆ–è€…æ ‡è¯†ç¬¦ã€‚

- å‡ ä¹ä¸ä¼šéœ€è¦ Symbolï¼Œä½†æ˜¯å®ƒä»¬å¯¹äºé‚£äº›é€šè¿‡åç§°å¼•ç”¨æ ‡è¯†ç¬¦çš„ API å¾ˆæœ‰ç”¨ï¼Œå› ä¸ºä»£ç å‹ç¼©åï¼Œå°½ç®¡æ ‡è¯†ç¬¦çš„åç§°ä¼šæ”¹å˜ï¼Œä½†æ˜¯å®ƒä»¬çš„ Symbol ä¼šä¿æŒä¸å˜ã€‚

å¯ä»¥ä½¿ç”¨åœ¨æ ‡è¯†ç¬¦å‰åŠ  # å‰ç¼€æ¥è·å– Symbolï¼š

```dart
#radix
#bar
```

Symbol å­—é¢é‡æ˜¯ç¼–è¯‘æ—¶å¸¸é‡ã€‚

---

_**ç»¼åˆèµ·æ¥çœ‹ï¼ŒåŸºæœ¬çš„ç±»å‹å’Œæ–¹æ³•ä¸ js ä¸­çš„ç±»ä¼¼ã€‚**_

# (ä¸‰) å‡½æ•°

- Dart æ˜¯ä¸€ç§çœŸæ­£é¢å‘å¯¹è±¡çš„è¯­è¨€ï¼Œæ‰€ä»¥å³ä¾¿å‡½æ•°ä¹Ÿæ˜¯å¯¹è±¡å¹¶ä¸”ç±»å‹ä¸º Functionã€‚
  - è¿™æ„å‘³ç€å‡½æ•°å¯ä»¥è¢«èµ‹å€¼ç»™å˜é‡æˆ–è€…ä½œä¸ºå…¶å®ƒå‡½æ•°çš„å‚æ•°ã€‚
  - ä½ ä¹Ÿå¯ä»¥åƒè°ƒç”¨å‡½æ•°ä¸€æ ·è°ƒç”¨ Dart ç±»çš„å®ä¾‹ã€‚
- `=>` (èƒ–ç®­å¤´) ç®€å†™è¯­æ³•ç”¨äºä»…åŒ…å«ä¸€æ¡è¯­å¥çš„å‡½æ•°ã€‚è¯¥è¯­æ³•åœ¨å°†åŒ¿åå‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’æ—¶éå¸¸æœ‰ç”¨ã€‚
  - è¯­æ³• `=> è¡¨è¾¾å¼` æ˜¯ `{ return è¡¨è¾¾å¼; }` çš„ç®€å†™ï¼Œ `=>` æœ‰æ—¶ä¹Ÿç§°ä¹‹ä¸º **ç®­å¤´å‡½æ•°**ã€‚

```dart
// å»ºè®® ä¸ºæ¯ä¸ªå‡½æ•°çš„å‚æ•°ä»¥åŠè¿”å›å€¼éƒ½æŒ‡å®šç±»å‹
int fibonacci(int n) {
  if (n == 0 || n == 1) return n;
  return fibonacci(n - 1) + fibonacci(n - 2);
}


// åœ¨ => ä¸ ; ä¹‹é—´çš„åªèƒ½æ˜¯ è¡¨è¾¾å¼ è€Œé è¯­å¥ã€‚
bool isEven(int number) => number % 2 == 0;

```

## å‚æ•°

- å¿…è¦å‚æ•° å’Œ å¯é€‰å‚æ•°
  - **å¿…è¦å‚æ•°å®šä¹‰åœ¨å‚æ•°åˆ—è¡¨å‰é¢ï¼Œå¯é€‰å‚æ•°åˆ™å®šä¹‰åœ¨å¿…è¦å‚æ•°åé¢**ã€‚
  - å¯é€‰å‚æ•°å¯ä»¥æ˜¯ `å‘½åçš„` æˆ– `ä½ç½®çš„`ã€‚
- ï¼ˆç®€å•ç†è§£ï¼šä¸æ˜¯å¯é€‰çš„ä½ç½®å‚æ•°å°±æ˜¯å¿…è¦å‚æ•°ï¼‰

- å‘½åå‚æ•°

  - å®šä¹‰å‡½æ•°æ—¶ï¼Œä½¿ç”¨ `{å‚æ•° 1, å‚æ•° 2, â€¦}` æ¥æŒ‡å®šå‘½åå‚æ•°ã€‚
  - **å‘½åå‚æ•°é»˜è®¤ä¸ºå¯é€‰å‚æ•°ï¼Œé™¤éä»–ä»¬è¢«ç‰¹åˆ«æ ‡è®°ä¸º required**ã€‚

- å¯é€‰çš„ä½ç½®å‚æ•°

  - **ä½¿ç”¨ `[]` å°†ä¸€ç³»åˆ—å‚æ•°åŒ…è£¹èµ·æ¥ä½œä¸ºä½ç½®å‚æ•°**ã€‚
  - ä¸ç”¨[]æˆ–è€…{}é‚£å°±æ˜¯å¿…å¡«çš„ä½ç½®å‚æ•°äº†ã€‚

- é»˜è®¤å‚æ•°å€¼

  - å¯ä»¥ç”¨ `=` ä¸ºå‡½æ•°çš„å‘½åå‚æ•°å’Œä½ç½®å‚æ•°å®šä¹‰é»˜è®¤å€¼ã€‚
  - é»˜è®¤å€¼å¿…é¡»ä¸ºç¼–è¯‘æ—¶å¸¸é‡ï¼Œæ²¡æœ‰æŒ‡å®šé»˜è®¤å€¼çš„æƒ…å†µä¸‹é»˜è®¤å€¼ä¸º nullã€‚
  - `List` æˆ– `Map` åŒæ ·ä¹Ÿå¯ä»¥ä½œä¸ºé»˜è®¤å€¼ã€‚

- å¯é€‰ä½ç½®å‚æ•°å’Œå¯é€‰å‘½åå‚æ•°ä¸èƒ½æ··åˆåœ¨ä¸€èµ·ä½¿ç”¨ï¼Œå› ä¸ºå¯é€‰å‚æ•°åˆ—è¡¨åªèƒ½ä½äºæ•´ä¸ªå‡½æ•°å½¢å‚åˆ—è¡¨çš„æœ€åã€‚

```dart
void main(List<String> args) {
  print(say('111', '222', 'phone'));
  // 111 says 222 with a phone action is Smile
}

String say(String from, String msg, [String? device, String? action = "Smile"]) {
  var result = '$from says $msg';
  if (device != null) {
    result = '$result with a $device action is $action';
  }
  return result;
}

```

## main() å‡½æ•°

æ¯ä¸ª Dart ç¨‹åºéƒ½å¿…é¡»æœ‰ä¸€ä¸ª main() é¡¶çº§å‡½æ•°ä½œä¸ºç¨‹åºçš„å…¥å£ï¼Œ main() å‡½æ•°è¿”å›å€¼ä¸º void å¹¶ä¸”æœ‰ä¸€ä¸ª `List<String>` ç±»å‹çš„å¯é€‰å‚æ•°ã€‚

```dart
void main(List<String> arguments) {
  print(arguments);

  assert(arguments.length == 2);
  assert(int.parse(arguments[0]) == 1);
  assert(arguments[1] == 'test');
}
/*
å°†æ­¤éƒ¨åˆ†ä»£ç ä¿å­˜ä¸ºtest.dartä¹‹åï¼Œåœ¨è¯¥æ–‡ä»¶çš„ç»ˆç«¯å‘½ä»¤è¿è¡Œï¼Œä¾‹å¦‚
`dart .\test.dart 1 test`
åˆ™ä¼šè¾“å‡ºå‚æ•°æ•°ç»„ï¼š[1, test]
*/
```

## å‡½æ•°æ˜¯ä¸€çº§å¯¹è±¡

- å¯ä»¥å°†å‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’ç»™å¦ä¸€ä¸ªå‡½æ•°ã€‚
- ä¹Ÿå¯ä»¥å°†å‡½æ•°èµ‹å€¼ç»™ä¸€ä¸ªå˜é‡ã€‚

```dart
// æœ€å¸¸ç”¨çš„å‡½æ•°ä½œä¸ºå‚æ•°ï¼šforEachçš„å‚æ•°
void printElement(int element) {
 print(element);
}
```

## åŒ¿åå‡½æ•°

- å¤§å¤šæ•°å‡½æ•°éƒ½æ˜¯æœ‰åå­—çš„ï¼Œæ¯”å¦‚ `main()` æˆ– `printElement()`ã€‚
- å¯ä»¥åˆ›å»ºä¸€ä¸ªæ²¡æœ‰åå­—çš„å‡½æ•°ï¼Œç§°ä¹‹ä¸º `åŒ¿åå‡½æ•°`ã€ `Lambda è¡¨è¾¾å¼` æˆ– `Closure é—­åŒ…`ã€‚
  - å¯ä»¥å°†åŒ¿åå‡½æ•°èµ‹å€¼ç»™ä¸€ä¸ªå˜é‡ç„¶åä½¿ç”¨å®ƒï¼Œæ¯”å¦‚å°†è¯¥å˜é‡æ·»åŠ åˆ°é›†åˆæˆ–ä»ä¸­åˆ é™¤ã€‚
- åŒ¿åå‡½æ•°çœ‹èµ·æ¥ä¸å‘½åå‡½æ•°ç±»ä¼¼ï¼Œåœ¨æ‹¬å·ä¹‹é—´å¯ä»¥å®šä¹‰å‚æ•°ï¼Œå‚æ•°ä¹‹é—´ç”¨é€—å·åˆ†å‰²ã€‚
  - **å¦‚æœå‡½æ•°ä½“å†…åªæœ‰ä¸€è¡Œè¿”å›è¯­å¥ï¼Œä½ å¯ä»¥ä½¿ç”¨èƒ–ç®­å¤´ç¼©å†™æ³•ã€‚**

åé¢å¤§æ‹¬å·ä¸­çš„å†…å®¹åˆ™ä¸ºå‡½æ•°ä½“ï¼š

```
([[ç±»å‹] å‚æ•°[, â€¦]]) {
  å‡½æ•°ä½“;
};
```

```dart
// å®šä¹‰äº†åªæœ‰ä¸€ä¸ªå‚æ•° item ä¸”æ²¡æœ‰å‚æ•°ç±»å‹çš„åŒ¿åæ–¹æ³•ã€‚
// List ä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½ä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼Œæ‰“å°å…ƒç´ ä½ç½®å’Œå€¼çš„å­—ç¬¦ä¸²
const list = ['apples', 'bananas', 'oranges'];

list.forEach((item) {
  print('${list.indexOf(item)}: $item');
});
```

## è¯æ³•ä½œç”¨åŸŸ

- Dart æ˜¯è¯æ³•æœ‰ä½œç”¨åŸŸè¯­è¨€ï¼Œå˜é‡çš„ä½œç”¨åŸŸåœ¨å†™ä»£ç çš„æ—¶å€™å°±ç¡®å®šäº†ï¼Œå¤§æ‹¬å·å†…å®šä¹‰çš„å˜é‡åªèƒ½åœ¨å¤§æ‹¬å·å†…è®¿é—®ï¼Œä¸ Java ç±»ä¼¼ã€‚

```dart
bool topLevel = true;

void main() {
  var insideMain = true;

  void myFunction() {
    var insideFunction = true;

    void nestedFunction() {
      var insideNestedFunction = true;

      print(topLevel);
      print(insideMain);
      print(insideFunction);
      print(insideNestedFunction);
    }

    nestedFunction(); // æ‰“å°4ä¸ª true
  }

  myFunction();
}
//  nestedFunction() å‡½æ•°å¯ä»¥è®¿é—®åŒ…æ‹¬é¡¶å±‚å˜é‡åœ¨å†…çš„æ‰€æœ‰çš„å˜é‡ã€‚
```

## è¯æ³•é—­åŒ…

- é—­åŒ… å³ä¸€ä¸ªå‡½æ•°å¯¹è±¡ï¼Œå³ä½¿å‡½æ•°å¯¹è±¡çš„è°ƒç”¨åœ¨å®ƒåŸå§‹ä½œç”¨åŸŸä¹‹å¤–ï¼Œä¾ç„¶èƒ½å¤Ÿè®¿é—®åœ¨å®ƒè¯æ³•ä½œç”¨åŸŸå†…çš„å˜é‡ã€‚
- å‡½æ•°å¯ä»¥å°é—­å®šä¹‰åˆ°å®ƒä½œç”¨åŸŸå†…çš„å˜é‡ã€‚

```dart
// å‡½æ•° makeAdder() æ•è·äº†å˜é‡ addByã€‚
// æ— è®ºå‡½æ•°åœ¨ä»€ä¹ˆæ—¶å€™è¿”å›ï¼Œå®ƒéƒ½å¯ä»¥ä½¿ç”¨æ•è·çš„ addBy å˜é‡ã€‚
Function makeAdder(int addBy) {
  return (int i) => addBy + i;
}

void main() {
  // Create a function that adds 2.
  var add2 = makeAdder(2);

  // Create a function that adds 4.
  var add4 = makeAdder(4);

  print(add2(3) == 5);
  print(add4(3) == 7);
}
```

## æµ‹è¯•å‡½æ•°æ˜¯å¦ç›¸ç­‰

ä¸‹é¢æ˜¯é¡¶çº§å‡½æ•°(top-level functions)ï¼Œé™æ€æ–¹æ³•(static methods)å’Œå®ä¾‹æ–¹æ³•(instance methods)ç›¸ç­‰æ€§çš„æµ‹è¯•ç¤ºä¾‹ã€‚

```dart
void foo() {} // ä¸€ä¸ªé¡¶çº§å‡½æ•°

class A {
  static void bar() {} // ä¸€ä¸ªé™æ€æ–¹æ³•
  void baz() {} // ä¸€ä¸ªå®ä¾‹æ–¹æ³•
}

void main() {
  Function x;

  // æ¯”è¾ƒé¡¶çº§æ–¹æ³•ã€‚
  x = foo;
  print('1: ${foo == x}'); // 1: true

  // æ¯”è¾ƒé™æ€æ–¹æ³•ã€‚
  x = A.bar;
  print(A.bar == x); // true

  // æ¯”è¾ƒå®ä¾‹æ–¹æ³•ã€‚
  var v = A(); // Instance #1 of A
  var w = A(); // Instance #2 of A
  var y = w;
  x = w.baz;

  // è¿™äº›é—­åŒ…å¼•ç”¨åŒä¸€ä¸ªå®ä¾‹ï¼ˆ#2ï¼‰ï¼Œå› æ­¤å®ƒä»¬æ˜¯ç›¸ç­‰çš„ã€‚
  print(y.baz == x);

  // è¿™äº›é—­åŒ…å¼•ç”¨ä¸åŒçš„å®ä¾‹ï¼Œå› æ­¤å®ƒä»¬æ˜¯ä¸ç›¸ç­‰çš„ã€‚
  print(v.baz != w.baz);
}
```

## è¿”å›å€¼

- æ‰€æœ‰çš„å‡½æ•°éƒ½æœ‰è¿”å›å€¼ã€‚æ²¡æœ‰æ˜¾ç¤ºè¿”å›è¯­å¥çš„å‡½æ•°æœ€åä¸€è¡Œé»˜è®¤ä¸ºæ‰§è¡Œ `return null;`ã€‚

## notes

- 1 å’Œ js çš„å‡½æ•°åŸºæœ¬ç±»ä¼¼ï¼Œæ³¨æ„å‡½æ•°çš„å‘½åå‚æ•°å’Œå¯é€‰ä½ç½®å‚æ•°ä¸èƒ½åŒæ—¶ç”¨ã€‚
- 2 æ¯ä¸ªå‡½æ•°éƒ½æœ‰è¿”å›å€¼ï¼Œå¦‚æœæ˜¯ `void`ï¼Œåˆ™æ˜¯çœç•¥äº† `return null;`ã€‚
- 3 ä¹Ÿæ˜¯æœ‰é—­åŒ…ï¼Œæ³¨æ„é—­åŒ…çš„ä¸¤ä¸ªä¸»è¦ç›®çš„å³å¯ï¼š
  - ä¸€ä¸ªæ˜¯å¯ä»¥åœ¨å…¨å±€ä½œç”¨åŸŸä¸­è¯»å–å†…éƒ¨å‡½æ•°çš„çš„å˜é‡ï¼Œ
  - å¦ä¸€ä¸ªå°±æ˜¯å¯ä»¥è®©é—­åŒ…ä¸­å¼•ç”¨çš„å˜é‡å§‹ç»ˆä¿å­˜åœ¨å†…å­˜ä¸­ã€‚
- 4 æ¯ä¸ª Dart ç¨‹åºéƒ½å¿…é¡»æœ‰ä¸€ä¸ª` main()` é¡¶çº§å‡½æ•°ä½œä¸ºç¨‹åºçš„å…¥å£ã€‚

# (å››)è¿ç®—ç¬¦

## ç®—æœ¯è¿ç®—ç¬¦

| è¿ç®—ç¬¦  | æè¿°                                       |
| ------- | ------------------------------------------ |
| +       | åŠ                                          |
| â€“       | å‡                                         |
| -è¡¨è¾¾å¼ | ä¸€å…ƒè´Ÿ, ä¹Ÿå¯ä»¥ä½œä¸ºåè½¬ï¼ˆåè½¬è¡¨è¾¾å¼çš„ç¬¦å·ï¼‰ |
| \*      | ä¹˜                                         |
| /       | é™¤                                         |
| ~/      | é™¤å¹¶å–æ•´                                   |
| %       | å–æ¨¡                                       |
| ++var   | var = var + 1 (è¡¨è¾¾å¼çš„å€¼ä¸º var + 1)       |
| var++   | var = var + 1 (è¡¨è¾¾å¼çš„å€¼ä¸º var)           |
| --var   | var = var â€“ 1 (è¡¨è¾¾å¼çš„å€¼ä¸º var â€“ 1)       |
| var--   | var = var â€“ 1 (è¡¨è¾¾å¼çš„å€¼ä¸º var)           |

## å…³ç³»è¿ç®—ç¬¦

| è¿ç®—ç¬¦ | æè¿°     |
| ------ | -------- |
| ==     | ç›¸ç­‰     |
| !=     | ä¸ç­‰     |
| \>     | å¤§äº     |
| \<     | å°äº     |
| >=     | å¤§äºç­‰äº |
| <=     | å°äºç­‰äº |

**è¦åˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡(objects) x å’Œ y æ˜¯å¦è¡¨ç¤ºç›¸åŒçš„äº‹ç‰©ä½¿ç”¨ `==` å³å¯ã€‚**

`==` è¿ç®—ç¬¦çš„ä¸€äº›è§„åˆ™:

- å½“ x å’Œ y åŒæ—¶ä¸ºç©ºæ—¶è¿”å› trueï¼Œè€Œåªæœ‰ä¸€ä¸ªä¸ºç©ºæ—¶è¿”å› falseã€‚
- è¿”å›å¯¹ x è°ƒç”¨ `==` æ–¹æ³•çš„ç»“æœï¼Œå‚æ•°ä¸º yã€‚ï¼ˆåƒ `==` è¿™æ ·çš„æ“ä½œç¬¦æ˜¯å¯¹å·¦ä¾§å†…å®¹è¿›è¡Œè°ƒç”¨çš„ã€‚)

## ç±»å‹åˆ¤æ–­è¿ç®—ç¬¦

`as`ã€`i`sã€`is!` è¿ç®—ç¬¦æ˜¯åœ¨è¿è¡Œæ—¶åˆ¤æ–­å¯¹è±¡ç±»å‹çš„è¿ç®—ç¬¦ã€‚
| è¿ç®—ç¬¦ | æè¿° |
| ------ | -------- |
| as| ç±»å‹è½¬æ¢ï¼ˆä¹Ÿç”¨ä½œæŒ‡å®š ç±»å‰ç¼€)ï¼‰|
| is| å¦‚æœå¯¹è±¡æ˜¯æŒ‡å®šç±»å‹åˆ™è¿”å› true|
| is!| å¦‚æœå¯¹è±¡æ˜¯æŒ‡å®šç±»å‹åˆ™è¿”å› false|

å½“ä¸”ä»…å½“ `obj` å®ç°äº† T çš„æ¥å£ï¼Œ`obj is T` æ‰æ˜¯ trueã€‚

ä¾‹å¦‚ `obj is Object` æ€»ä¸º trueï¼Œå› ä¸ºæ‰€æœ‰ç±»éƒ½æ˜¯ Object çš„å­ç±»ã€‚  
ä»…å½“ä½ ç¡®å®šè¿™ä¸ªå¯¹è±¡æ˜¯è¯¥ç±»å‹çš„æ—¶å€™ï¼Œä½ æ‰å¯ä»¥ä½¿ç”¨ `as` æ“ä½œç¬¦å¯ä»¥æŠŠå¯¹è±¡è½¬æ¢ä¸ºç‰¹å®šçš„ç±»å‹ã€‚

```dart
(employee as Person).firstName = 'Bob';

// å¦‚æœä½ ä¸ç¡®å®šè¿™ä¸ªå¯¹è±¡ç±»å‹æ˜¯ä¸æ˜¯ Tï¼Œè¯·åœ¨è½¬å‹å‰ä½¿ç”¨ is T æ£€æŸ¥ç±»å‹ã€‚

if (employee is Person) {
  // Type check
  employee.firstName = 'Bob';
}

// ä¸Šè¿°ä¸¤ç§æ–¹å¼æ˜¯æœ‰åŒºåˆ«çš„ï¼šå¦‚æœ employee ä¸º null æˆ–è€…ä¸ä¸º Person ç±»å‹ï¼Œåˆ™ç¬¬ä¸€ç§æ–¹å¼å°†ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œè€Œç¬¬äºŒç§ä¸ä¼šã€‚
```

## èµ‹å€¼è¿ç®—ç¬¦

å¯ä»¥ä½¿ç”¨ `=` æ¥èµ‹å€¼ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥ä½¿ç”¨ `??=` æ¥ä¸ºå€¼ä¸º null çš„å˜é‡èµ‹å€¼ã€‚

```dart
// Assign value to a
a = value;
// Assign value to b if b is null; otherwise, b stays the same
// bä¸ºnullåˆ™èµ‹å€¼ä¸ºvalueï¼Œå¦åˆ™è¿˜æ˜¯b
b ??= value;
```

**`+=` è¿™æ ·çš„èµ‹å€¼è¿ç®—ç¬¦å°†ç®—æ•°è¿ç®—ç¬¦å’Œèµ‹å€¼è¿ç®—ç¬¦ç»„åˆåœ¨äº†ä¸€èµ·**  
| | | | | |
| ------ | -------- |-------- |-------- |-------- |
|= |\*= |%=| >>>=| ^=|
|+=| /=| <<=| &= |=|
|-=| ~/=| >>=|

eg:  
**`a op= b` ==> `a = a op b`**  
`a += b` ==> `a = a + b`

## é€»è¾‘è¿ç®—ç¬¦

| è¿ç®—ç¬¦  | æè¿°                                                      |
| ------- | --------------------------------------------------------- |
| !è¡¨è¾¾å¼ | å¯¹è¡¨è¾¾å¼ç»“æœå–åï¼ˆå³å°† true å˜ä¸º falseï¼Œfalse å˜ä¸º trueï¼‰ |
| \|\|    | é€»è¾‘æˆ–                                                    |
| &&      | é€»è¾‘ä¸                                                    |

## æŒ‰ä½å’Œç§»ä½è¿ç®—ç¬¦

åœ¨ Dart ä¸­ï¼ŒäºŒè¿›åˆ¶ä½è¿ç®—ç¬¦å¯ä»¥æ“ä½œäºŒè¿›åˆ¶çš„æŸä¸€ä½ï¼Œ**ä½†ä»…é€‚ç”¨äºæ•´æ•°**ã€‚
| è¿ç®—ç¬¦ | æè¿° |
| ------- | ----|
|& |æŒ‰ä½ä¸|
|\| |æŒ‰ä½æˆ–|
|^| æŒ‰ä½å¼‚æˆ–|
|~è¡¨è¾¾å¼| æŒ‰ä½å–åï¼ˆå³å°† â€œ0â€ å˜ä¸º â€œ1â€ï¼Œâ€œ1â€ å˜ä¸º â€œ0â€ï¼‰|
|<<| ä½å·¦ç§»|
|>> |ä½å³ç§»|
|>>> |æ— ç¬¦å·å³ç§»|

**`>>>` æ“ä½œç¬¦åœ¨ 2.14 ä»¥ä¸Šçš„ Dart ç‰ˆæœ¬ ä¸­å¯ç”¨ã€‚**

## æ¡ä»¶è¡¨è¾¾å¼

_æ¡ä»¶ ? è¡¨è¾¾å¼ 1 : è¡¨è¾¾å¼ 2_  
å¦‚æœæ¡ä»¶ä¸º trueï¼Œæ‰§è¡Œè¡¨è¾¾å¼ 1 å¹¶è¿”å›æ‰§è¡Œç»“æœï¼Œå¦åˆ™æ‰§è¡Œè¡¨è¾¾å¼ 2 å¹¶è¿”å›æ‰§è¡Œç»“æœã€‚

_è¡¨è¾¾å¼ 1 ?? è¡¨è¾¾å¼ 2_  
å¦‚æœè¡¨è¾¾å¼ 1 ä¸ºé null åˆ™è¿”å›å…¶å€¼ï¼Œå¦åˆ™æ‰§è¡Œè¡¨è¾¾å¼ 2 å¹¶è¿”å›å…¶å€¼ã€‚

```dart
// æ ¹æ®å¸ƒå°”è¡¨è¾¾å¼ç¡®å®šèµ‹å€¼æ—¶ï¼Œè¯·è€ƒè™‘ä½¿ç”¨ ? å’Œ :
var visibility = isPublic ? 'public' : 'private';

// å¦‚æœèµ‹å€¼æ˜¯æ ¹æ®åˆ¤å®šæ˜¯å¦ä¸º null åˆ™è€ƒè™‘ä½¿ç”¨ ??ã€‚
String playerName(String? name) => name ?? 'Guest';
```

## çº§è”è¿ç®—ç¬¦

çº§è”è¿ç®—ç¬¦ (**`..`** å’Œ **`?..`**) å¯ä»¥**åœ¨åŒä¸€ä¸ªå¯¹è±¡ä¸Šè¿ç»­è°ƒç”¨å¤šä¸ªå¯¹è±¡çš„å˜é‡æˆ–æ–¹æ³•ã€‚**

```dart
var paint = Paint()
  ..color = Colors.black
  ..strokeCap = StrokeCap.round
  ..strokeWidth = 5.0;

// æ„é€ å‡½æ•°Paint()è¿”å›ä¸€ä¸ªPaintå¯¹è±¡ã€‚çº§è”ç¬¦å·åé¢çš„ä»£ç å¯¹è¯¥å¯¹è±¡è¿›è¡Œæ“ä½œï¼Œå¿½ç•¥ä»»ä½•å¯èƒ½è¿”å›çš„å€¼ã€‚
// ç­‰ä»·äºï¼š
var paint = Paint();
paint.color = Colors.black;
paint.strokeCap = StrokeCap.round;
paint.strokeWidth = 5.0;
```

## å…¶ä»–è¿ç®—ç¬¦

| è¿ç®—ç¬¦ | åå­—         | æè¿°                                                                                                                   |
| ------ | ------------ | ---------------------------------------------------------------------------------------------------------------------- |
| ()     | ä½¿ç”¨æ–¹æ³•     | ä»£è¡¨è°ƒç”¨ä¸€ä¸ªæ–¹æ³•                                                                                                       |
| []     | è®¿é—® List    | è®¿é—® List ä¸­ç‰¹å®šä½ç½®çš„å…ƒç´                                                                                              |
| ?[]    | åˆ¤ç©ºè®¿é—®     | List å·¦ä¾§è°ƒç”¨è€…ä¸ä¸ºç©ºæ—¶ï¼Œè®¿é—® List ä¸­ç‰¹å®šä½ç½®çš„å…ƒç´                                                                     |
| .      | è®¿é—®æˆå‘˜     | æˆå‘˜è®¿é—®ç¬¦                                                                                                             |
| ?.     | æ¡ä»¶è®¿é—®æˆå‘˜ | ä¸ä¸Šè¿°æˆå‘˜è®¿é—®ç¬¦ç±»ä¼¼ï¼Œä½†æ˜¯å·¦è¾¹çš„æ“ä½œå¯¹è±¡ä¸èƒ½ä¸º nullã€‚<br/>ä¾‹å¦‚ `foo?.bar`ï¼Œå¦‚æœ foo ä¸º null åˆ™è¿”å› null ï¼Œå¦åˆ™è¿”å› bar |

# (äº”) æ§åˆ¶æµç¨‹è¯­å¥

## åŸºç¡€æ§åˆ¶æµç¨‹è¯­å¥

- if else
  - ä¸åŒäº JavaScriptï¼ŒDart çš„ if è¯­å¥ä¸­çš„æ¡ä»¶å¿…é¡»æ˜¯å¸ƒå°”å€¼è€Œä¸èƒ½ä¸ºå…¶å®ƒç±»å‹ã€‚
- forã€
  - for å¾ªç¯ä¸­çš„é—­åŒ…ä¼šè‡ªåŠ¨æ•è·å¾ªç¯çš„ ç´¢å¼•å€¼ ä»¥é¿å… JavaScript ä¸­ä¸€äº›å¸¸è§çš„é™·é˜±ã€‚
- for in
  - å¦‚æœè¦éå†çš„å¯¹è±¡æ˜¯ä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡ï¼ˆä¾‹å¦‚ List æˆ– Setï¼‰ï¼Œå¹¶ä¸”ä½ ä¸éœ€è¦çŸ¥é“å½“å‰çš„éå†ç´¢å¼•ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ for-in æ–¹æ³•è¿›è¡Œ éå†ã€‚
- forEach
  - å¯è¿­ä»£å¯¹è±¡åŒæ—¶å¯ä»¥ä½¿ç”¨ forEach() æ–¹æ³•ä½œä¸ºå¦ä¸€ç§é€‰æ‹©ã€‚
- while
  - while å¾ªç¯ä¼šåœ¨æ‰§è¡Œå¾ªç¯ä½“å‰å…ˆåˆ¤æ–­æ¡ä»¶ã€‚
  - do-while å¾ªç¯åˆ™ä¼š å…ˆæ‰§è¡Œä¸€éå¾ªç¯ä½“ å†åˆ¤æ–­æ¡ä»¶ã€‚
- Break å’Œ Continue
  - ä½¿ç”¨ break å¯ä»¥ä¸­æ–­å¾ªç¯ã€‚
  - ä½¿ç”¨ continue å¯ä»¥è·³è¿‡æœ¬æ¬¡å¾ªç¯ç›´æ¥è¿›å…¥ä¸‹ä¸€æ¬¡å¾ªç¯ã€‚
- Switch å’Œ Case
  - Dart ä¸­çš„ Switch è¯­å¥ä»…é€‚ç”¨äºæœ‰é™çš„æƒ…å†µï¼Œæ¯”å¦‚ä½¿ç”¨è§£é‡Šå™¨å’Œæ‰«æå™¨çš„åœºæ™¯ã€‚
  - æ¯ä¸€ä¸ªéç©ºçš„ case å­å¥éƒ½å¿…é¡»æœ‰ä¸€ä¸ª break è¯­å¥ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ continueã€throw æˆ–è€… return æ¥ç»“æŸéç©º case è¯­å¥ã€‚
- æ–­è¨€ Assert
  - åœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œå¯ä»¥åœ¨æ¡ä»¶è¡¨è¾¾å¼ä¸º false æ—¶ä½¿ç”¨ _`assert(æ¡ä»¶, å¯é€‰ä¿¡æ¯);`_ è¯­å¥æ¥æ‰“æ–­ä»£ç çš„æ‰§è¡Œã€‚
  - assert çš„ç¬¬ä¸€ä¸ªå‚æ•°å¯ä»¥æ˜¯å€¼ä¸ºå¸ƒå°”å€¼çš„ä»»ä½•è¡¨è¾¾å¼ã€‚
    - å¦‚æœè¡¨è¾¾å¼çš„å€¼ä¸º trueï¼Œåˆ™æ–­è¨€æˆåŠŸï¼Œç»§ç»­æ‰§è¡Œã€‚
    - å¦‚æœè¡¨è¾¾å¼çš„å€¼ä¸º falseï¼Œåˆ™æ–­è¨€å¤±è´¥ï¼ŒæŠ›å‡ºä¸€ä¸ª `AssertionError` å¼‚å¸¸ã€‚
- å¼‚å¸¸
  - Dart çš„æ‰€æœ‰å¼‚å¸¸éƒ½æ˜¯éå¿…æ£€å¼‚å¸¸ï¼Œæ–¹æ³•ä¸å¿…å£°æ˜ä¼šæŠ›å‡ºå“ªäº›å¼‚å¸¸ï¼Œå¹¶ä¸”ä½ ä¹Ÿä¸å¿…æ•è·ä»»ä½•å¼‚å¸¸ã€‚
  - Dart æä¾›äº† `Exception` å’Œ `Error` ä¸¤ç§ç±»å‹çš„å¼‚å¸¸ä»¥åŠå®ƒä»¬ä¸€ç³»åˆ—çš„å­ç±»ï¼Œä¹Ÿå¯ä»¥å®šä¹‰è‡ªå·±çš„å¼‚å¸¸ç±»å‹ã€‚
  - `throw` å¼‚å¸¸
  - `try on catch finally` å¼‚å¸¸
  - `rethrow` å¼‚å¸¸

```dart
void baseControlTest() {
  var year = 2021;
  var number = 100;
  var flybyObjects = [1, 2, 3];

// Dart çš„ if è¯­å¥ä¸­çš„æ¡ä»¶å¿…é¡»æ˜¯å¸ƒå°”å€¼è€Œä¸èƒ½ä¸ºå…¶å®ƒç±»å‹ã€‚
  if (year >= 2001) {
    print('21st century');
  } else if (year >= 1901) {
    print('20th century');
  }

// åŸºæœ¬forå¾ªç¯
  // for (int month = 1; month <= 12; month++) {
  //   print(month);
  // }

// åœ¨ Dart è¯­è¨€ä¸­ï¼Œfor å¾ªç¯ä¸­çš„é—­åŒ…ä¼šè‡ªåŠ¨æ•è·å¾ªç¯çš„ ç´¢å¼•å€¼ ä»¥é¿å… JavaScript ä¸­ä¸€äº›å¸¸è§çš„é™·é˜±ã€‚
// è¿™ä¸ªä»£ç åœ¨jsä¼šæ‰“å°2 2
  var callbacks = [];
  for (var i = 0; i < 2; i++) {
    callbacks.add(() => print(i));
  }
  callbacks.forEach((c) => c());

// éå†çš„å¯¹è±¡æ˜¯ä¸€ä¸ªå¯è¿­ä»£å¯¹è±¡ï¼ˆä¾‹å¦‚ List æˆ– Setï¼‰ï¼Œå¹¶ä¸”ä½ ä¸éœ€è¦çŸ¥é“å½“å‰çš„éå†ç´¢å¼•ï¼Œå¯ä»¥ä½¿ç”¨for in
  for (final object in flybyObjects) {
    print(object);
  }

// while å¾ªç¯ä¼šåœ¨æ‰§è¡Œå¾ªç¯ä½“å‰å…ˆåˆ¤æ–­æ¡ä»¶ï¼š
  while (year < 2016) {
    year += 1;
  }
  print("year is $year"); // 2021

// do-while å¾ªç¯åˆ™ä¼š å…ˆæ‰§è¡Œä¸€éå¾ªç¯ä½“ å†åˆ¤æ–­æ¡ä»¶
  do {
    number += 1;
  } while (number < 60);

  print("year is $number"); // 101

// ä½¿ç”¨ break å¯ä»¥ä¸­æ–­å¾ªç¯
// ä½¿ç”¨ continue å¯ä»¥è·³è¿‡æœ¬æ¬¡å¾ªç¯ç›´æ¥è¿›å…¥ä¸‹ä¸€æ¬¡å¾ªç¯
  for (int i = 0; i < 100; i++) {
    if (i < 5) {
      continue;
    }
    if (i >= 10) {
      break;
    }
    print("i is $i"); // 5 6 7 8 9
  }

  // Switch è¯­å¥åœ¨ Dart ä¸­ä½¿ç”¨ == æ¥æ¯”è¾ƒæ•´æ•°ã€å­—ç¬¦ä¸²æˆ–ç¼–è¯‘æ—¶å¸¸é‡ï¼Œ
  // æ¯”è¾ƒçš„ä¸¤ä¸ªå¯¹è±¡å¿…é¡»æ˜¯åŒä¸€ä¸ªç±»å‹ä¸”ä¸èƒ½æ˜¯å­ç±»å¹¶ä¸”æ²¡æœ‰é‡å†™ == æ“ä½œç¬¦ã€‚
  // æšä¸¾ç±»å‹éå¸¸é€‚åˆåœ¨ Switch è¯­å¥ä¸­ä½¿ç”¨ã€‚

  // æ¯ä¸€ä¸ªéç©ºçš„ case å­å¥éƒ½å¿…é¡»æœ‰ä¸€ä¸ª break è¯­å¥ï¼Œ
  // ä¹Ÿå¯ä»¥é€šè¿‡ continueã€throw æˆ–è€… return æ¥ç»“æŸéç©º case è¯­å¥ã€‚
  // ä¸åŒ¹é…ä»»ä½• case è¯­å¥çš„æƒ…å†µä¸‹ï¼Œä¼šæ‰§è¡Œ default å­å¥ä¸­çš„ä»£ç ã€‚
  var command = 'OPEN';
  switch (command) {
    case 'CLOSED': // æ”¯æŒç©ºçš„ case è¯­å¥ï¼Œå…è®¸å…¶ä»¥ fall-through çš„å½¢å¼æ‰§è¡Œã€‚
    // break;               // å¦‚æœè¾“å…¥çš„æ˜¯CLOSEDï¼Œæœ‰breakï¼Œç›´æ¥è¿”å›ã€‚æ²’æœ‰breakï¼Œè¿”å›PENDINGçš„æ‰§è¡Œã€‚
    case 'PENDING':
      print("executePending()");
      break;
    case 'APPROVED': // éç©º case è¯­å¥ä¸­æƒ³è¦å®ç° fall-through çš„å½¢å¼ï¼Œå¯ä»¥ä½¿ç”¨ continue è¯­å¥é…åˆ label çš„æ–¹å¼å®ç°:
      print("executeApproved()");
      continue nowApproved;
    case 'DENIED':
      print("executeDenied()");
      break;
    nowApproved:
    case 'OPEN': // Runs for both APPROVED and OPEN.
      print("executeOpen()");
      break;
    default:
      print("executeUnknown()");
  }

  // åœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œå¯ä»¥åœ¨æ¡ä»¶è¡¨è¾¾å¼ä¸º false æ—¶ä½¿ç”¨ â€” assert(æ¡ä»¶, å¯é€‰ä¿¡æ¯); â€” è¯­å¥æ¥æ‰“æ–­ä»£ç çš„æ‰§è¡Œã€‚
  // ç¬¬äºŒä¸ªå‚æ•°å¯ä»¥ä¸ºå…¶æ·»åŠ ä¸€ä¸ªå­—ç¬¦ä¸²æ¶ˆæ¯ã€‚
  var text, num, urlString;
  // Make sure the variable has a non-null value.
  assert(text != null);

// Make sure the value is less than 100.
  assert(num < 100);

// Make sure this is an https URL.
  assert(urlString.startsWith('https'),
      'URL ($urlString) should start with "https".');

  // assert çš„ç¬¬ä¸€ä¸ªå‚æ•°å¯ä»¥æ˜¯å€¼ä¸ºå¸ƒå°”å€¼çš„ä»»ä½•è¡¨è¾¾å¼ã€‚å¦‚æœè¡¨è¾¾å¼çš„å€¼ä¸º trueï¼Œåˆ™æ–­è¨€æˆåŠŸï¼Œç»§ç»­æ‰§è¡Œã€‚
  // å¦‚æœè¡¨è¾¾å¼çš„å€¼ä¸º falseï¼Œåˆ™æ–­è¨€å¤±è´¥ï¼ŒæŠ›å‡ºä¸€ä¸ª AssertionError å¼‚å¸¸ã€‚
}

// Dart ä»£ç å¯ä»¥æŠ›å‡ºå’Œæ•è·å¼‚å¸¸ã€‚
// ä¸ Java ä¸åŒçš„æ˜¯ï¼ŒDart çš„æ‰€æœ‰å¼‚å¸¸éƒ½æ˜¯éå¿…æ£€å¼‚å¸¸ï¼Œæ–¹æ³•ä¸å¿…å£°æ˜ä¼šæŠ›å‡ºå“ªäº›å¼‚å¸¸ï¼Œå¹¶ä¸”ä½ ä¹Ÿä¸å¿…æ•è·ä»»ä½•å¼‚å¸¸ã€‚
void distanceTo(int other) => throw UnimplementedError("å¼‚å¸¸ä¿¡æ¯");

void misbehave() {
  try {
    dynamic foo = true;
    print(foo++); // Runtime error
  } on NoSuchMethodError catch (e) {
    // ä½¿ç”¨ on æ¥æŒ‡å®šå¼‚å¸¸ç±»å‹ï¼Œä½¿ç”¨ catch æ¥æ•è·å¼‚å¸¸å¯¹è±¡ï¼Œä¸¤è€…å¯åŒæ—¶ä½¿ç”¨ã€‚
    print('NoSuchMethodError: $e');
    // å…³é”®å­— rethrow å¯ä»¥å°†æ•è·çš„å¼‚å¸¸å†æ¬¡æŠ›å‡º
    rethrow; // Allow callers to see the exception.
  } catch (e) {
    // å¦‚æœ catch è¯­å¥æ²¡æœ‰æŒ‡å®šå¼‚å¸¸ç±»å‹åˆ™è¡¨ç¤ºå¯ä»¥æ•è·ä»»æ„å¼‚å¸¸ç±»å‹(åœ¨ä¸Šé¢å·²ç»catchäº†ï¼Œå°±ä¸ä¼šåˆ°è¿™é‡Œäº†)
    print('misbehave() partially handled ${e.runtimeType}.');
    // å…³é”®å­— rethrow å¯ä»¥å°†æ•è·çš„å¼‚å¸¸å†æ¬¡æŠ›å‡º
    rethrow; // Allow callers to see the exception.
  } finally {
    // æ— è®ºæ˜¯å¦æŠ›å‡ºå¼‚å¸¸ï¼Œfinally è¯­å¥å§‹ç»ˆæ‰§è¡Œï¼Œ
    // å¦‚æœæ²¡æœ‰æŒ‡å®š catch è¯­å¥æ¥æ•è·å¼‚å¸¸ï¼Œåˆ™å¼‚å¸¸ä¼šåœ¨æ‰§è¡Œå®Œ finally è¯­å¥åæŠ›å‡º
    print("æ— è®ºå¦‚ä½•ï¼Œéƒ½ä¼šæ‰§è¡Œåœ¨finally");
  }
}

void main() {
  baseControlTest();
  var text;
  assert(text != null);

  try {
    misbehave();
  } catch (e) {
    print('main() finished handling ${e.runtimeType}.');
  }
}
```

## note

- å’Œåœ¨ js ä¸­çš„å¸¸ç”¨æ§åˆ¶è¯­å¥ç”¨æ³•åŸºæœ¬ä¸€è‡´ï¼Œæ²’ä»€ä¹ˆç‰¹æ®Šçš„ã€‚

# (å…­) ç±»

## ä½¿ç”¨ç±»

- Dart æ˜¯æ”¯æŒåŸºäº mixin ç»§æ‰¿æœºåˆ¶çš„é¢å‘å¯¹è±¡è¯­è¨€ã€‚
- æ‰€æœ‰å¯¹è±¡éƒ½æ˜¯ä¸€ä¸ªç±»çš„å®ä¾‹ï¼Œè€Œé™¤äº† Null ä»¥å¤–çš„æ‰€æœ‰çš„ç±»éƒ½ç»§æ‰¿è‡ª Object ç±»ã€‚
- `åŸºäº mixin çš„ç»§æ‰¿` æ„å‘³ç€å°½ç®¡æ¯ä¸ªç±»ï¼ˆé¡¶å±‚ç±» `Object?` é™¤å¤–ï¼‰éƒ½åªæœ‰ä¸€ä¸ªè¶…ç±»ã€‚
- ä¸€ä¸ªç±»çš„ä»£ç å¯ä»¥åœ¨å…¶å®ƒå¤šä¸ªç±»ç»§æ‰¿ä¸­é‡å¤ä½¿ç”¨ã€‚

- æ‰©å±•æ–¹æ³•(Extension methods) æ˜¯ä¸€ç§åœ¨ä¸æ›´æ”¹ç±»æˆ–åˆ›å»ºå­ç±»çš„æƒ…å†µä¸‹å‘ç±»æ·»åŠ åŠŸèƒ½çš„æ–¹å¼ã€‚

### ä½¿ç”¨ç±»çš„æˆå‘˜

- å¯¹è±¡çš„ æˆå‘˜ ç”±å‡½æ•°å’Œæ•°æ®ï¼ˆå³ `æ–¹æ³•(methods)` å’Œ `å®ä¾‹å˜é‡(instance variables)`ï¼‰ç»„æˆã€‚
- æ–¹æ³•çš„ è°ƒç”¨ è¦é€šè¿‡å¯¹è±¡æ¥å®Œæˆï¼Œè¿™ç§æ–¹å¼å¯ä»¥è®¿é—®å¯¹è±¡çš„å‡½æ•°å’Œæ•°æ®ã€‚
- ä½¿ç”¨ï¼ˆ`.`ï¼‰æ¥è®¿é—®å¯¹è±¡çš„å®ä¾‹å˜é‡æˆ–æ–¹æ³•ã€‚
- ä½¿ç”¨ `?.` ä»£æ›¿ `.` å¯ä»¥é¿å…å› ä¸ºå·¦è¾¹è¡¨è¾¾å¼ä¸º null è€Œå¯¼è‡´çš„é—®é¢˜

```dart
var p = Point(2, 2);

// Get the value of y.
assert(p.y == 2);

// Invoke distanceTo() on p [è°ƒç”¨å®ä¾‹pä¸Šçš„distanceTo()æ–¹æ³•].
double distance = p.distanceTo(Point(4, 4));
// If p is non-null, set a variable equal to its y value.
var a = p?.y;
```

### ä½¿ç”¨æ„é€ å‡½æ•°

å¯ä»¥ä½¿ç”¨ **æ„é€ å‡½æ•°** æ¥åˆ›å»ºä¸€ä¸ªå¯¹è±¡ã€‚æ„é€ å‡½æ•°çš„å‘½åæ–¹å¼å¯ä»¥ä¸º _`ç±»å`_ æˆ– _`ç±»å.æ ‡è¯†ç¬¦`_ çš„å½¢å¼ã€‚ä¾‹å¦‚ä¸‹è¿°ä»£ç åˆ†åˆ«ä½¿ç”¨ `Point()` å’Œ `Point.fromJson()` ä¸¤ç§æ„é€ å™¨åˆ›å»ºäº† Point å¯¹è±¡ï¼š

```dart
var p1 = Point(2, 2);
var p2 = Point.fromJson({'x': 1, 'y': 2});
```

ä»¥ä¸‹ä»£ç å…·æœ‰ç›¸åŒçš„æ•ˆæœï¼Œä½†æ˜¯*æ„é€ å‡½æ•°åå‰é¢çš„çš„ new å…³é”®å­—æ˜¯å¯é€‰çš„*(æœ€å¥½ä¸ç”¨)ï¼š

```dart
var p1 = new Point(2, 2);
var p2 = new Point.fromJson({'x': 1, 'y': 2});
```

ä¸€äº›ç±»æä¾›äº†ã€**å¸¸é‡æ„é€ å‡½æ•°**ã€‘(å¦‚æœç±»ç”Ÿæˆçš„å¯¹è±¡éƒ½æ˜¯ä¸å˜çš„ï¼Œå¯ä»¥åœ¨ç”Ÿæˆè¿™äº›å¯¹è±¡æ—¶å°±å°†å…¶å˜ä¸ºç¼–è¯‘æ—¶å¸¸é‡ã€‚)ã€‚ä½¿ç”¨å¸¸é‡æ„é€ å‡½æ•°ï¼Œåœ¨æ„é€ å‡½æ•°åä¹‹å‰åŠ  const å…³é”®å­—ï¼Œæ¥åˆ›å»ºç¼–è¯‘æ—¶å¸¸é‡æ—¶ï¼š

```dart
var p = const ImmutablePoint(2, 2);
```

ä¸¤ä¸ªä½¿ç”¨ç›¸åŒæ„é€ å‡½æ•°ç›¸åŒå‚æ•°å€¼æ„é€ çš„ç¼–è¯‘æ—¶å¸¸é‡æ˜¯åŒä¸€ä¸ªå¯¹è±¡ï¼š

```dart
var a = const ImmutablePoint(1, 1);
var b = const ImmutablePoint(1, 1);

assert(identical(a, b)); // They are the same instance!
```

**åœ¨ _å¸¸é‡ä¸Šä¸‹æ–‡_ åœºæ™¯ä¸­ï¼Œä½ å¯ä»¥çœç•¥æ‰æ„é€ å‡½æ•°æˆ–å­—é¢é‡å‰çš„ const å…³é”®å­—ã€‚**

ä¾‹å¦‚ä¸‹é¢çš„ä¾‹å­ä¸­æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªå¸¸é‡ Mapï¼š

```dart
// Lots of const keywords here.
const pointAndLine = const {
  'point': const [const ImmutablePoint(0, 0)],
  'line': const [const ImmutablePoint(1, 10), const ImmutablePoint(-2, 11)],
};
// æ ¹æ®ä¸Šä¸‹æ–‡ï¼Œä½ å¯ä»¥åªä¿ç•™ç¬¬ä¸€ä¸ª const å…³é”®å­—ï¼Œå…¶ä½™çš„å…¨éƒ¨çœç•¥ï¼š

// Only one const, which establishes the constant context.
const pointAndLine = {
  'point': [ImmutablePoint(0, 0)],
  'line': [ImmutablePoint(1, 10), ImmutablePoint(-2, 11)],
};
```

**ä½†æ˜¯å¦‚æœæ— æ³•æ ¹æ®ä¸Šä¸‹æ–‡åˆ¤æ–­æ˜¯å¦å¯ä»¥çœç•¥ constï¼Œåˆ™ä¸èƒ½çœç•¥æ‰ const å…³é”®å­—ï¼Œå¦åˆ™å°†ä¼šåˆ›å»ºä¸€ä¸ª éå¸¸é‡å¯¹è±¡**ã€‚

ä¾‹å¦‚ï¼š

```dart
var a = const ImmutablePoint(1, 1); // Creates a constant
var b = ImmutablePoint(1, 1); // Does NOT create a constant

assert(!identical(a, b)); // NOT the same instance!
```

### è·å–å¯¹è±¡çš„ç±»å‹

å¯ä»¥ä½¿ç”¨ `Object å¯¹è±¡çš„ runtimeType å±æ€§`åœ¨è¿è¡Œæ—¶è·å–ä¸€ä¸ªå¯¹è±¡çš„ç±»å‹ï¼Œè¯¥å¯¹è±¡ç±»å‹æ˜¯ Type çš„å®ä¾‹ã€‚

```dart
print('The type of a is ${a.runtimeType}');
```

åœ¨ç”Ÿäº§ç¯å¢ƒä½¿ç”¨**ç±»å‹åˆ¤æ–­è¿ç®—ç¬¦**ï¼š

- `as`[ç±»å‹è½¬æ¢ï¼ˆä¹Ÿç”¨ä½œæŒ‡å®š ç±»å‰ç¼€)ï¼‰]ã€
- `is`[å¦‚æœå¯¹è±¡æ˜¯æŒ‡å®šç±»å‹åˆ™è¿”å› true]ã€
- `is!`[å¦‚æœå¯¹è±¡æ˜¯æŒ‡å®šç±»å‹åˆ™è¿”å› false]ã€‚

è¿ç®—ç¬¦æ˜¯åœ¨è¿è¡Œæ—¶åˆ¤æ–­å¯¹è±¡ç±»å‹çš„è¿ç®—ç¬¦ã€‚

## å®ç°ä¸€ä¸ªç±»(ç±»åŒ…å«çš„ä¸œè¥¿)

### å®ä¾‹å˜é‡(Instance variables)

ä¸‹é¢æ˜¯å£°æ˜å®ä¾‹å˜é‡çš„ç¤ºä¾‹ï¼š

```dart
class Point {
  double? x; // Declare instance variable x, initially null.
  double? y; // Declare y, initially null.
  double z = 0; // Declare z, initially 0.
}
```

**æ‰€æœ‰æœªåˆå§‹åŒ–çš„å®ä¾‹å˜é‡å…¶å€¼å‡ä¸º nullã€‚**  
**æ‰€æœ‰å®ä¾‹å˜é‡å‡ä¼šéšå¼åœ°å£°æ˜ä¸€ä¸ª Getter æ–¹æ³•ã€‚**
**éç»ˆå€¼(non-final)çš„å®ä¾‹å˜é‡å’Œ late final å£°æ˜ä½†æœªå£°æ˜åˆå§‹åŒ–çš„å®ä¾‹å˜é‡è¿˜ä¼šéšå¼åœ°å£°æ˜ä¸€ä¸ª Setter æ–¹æ³•ã€‚**

```dart
void main() {
  var point = Point();
  point.x = 4; // Use the setter method for x.
  assert(point.x == 4); // Use the getter method for x.
  assert(point.y == null); // Values default to null.
}
```

å¦‚æœå®ä¾‹å˜é‡æ˜¯ `final` çš„ï¼Œé‚£å°±å¿…é¡»åˆå§‹åŒ–ã€‚  
åœ¨å£°æ˜æ—¶ï¼Œä½¿ç”¨æ„é€ å‡½æ•°å‚æ•°æˆ–ä½¿ç”¨æ„é€ å‡½æ•°çš„åˆå§‹åŒ–å™¨åˆ—è¡¨åˆå§‹åŒ– `final`ã€`non-late` å®ä¾‹å˜é‡ã€‚

```dart
class ProfileMark {
  final String name;
  final DateTime start = DateTime.now();    // ç›´æ¥åˆå§‹åŒ–

  ProfileMark(this.name);
  ProfileMark.unnamed() : name = '';    // ä½¿ç”¨æ„é€ å‡½æ•°åˆå§‹åŒ–åˆ—è¡¨ ï¼ˆconstructorâ€™s initializer listï¼‰åˆå§‹åŒ–
}
```

### æ„é€ å‡½æ•°(constructors)

- å£°æ˜ä¸€ä¸ªä¸ç±»åä¸€æ ·çš„å‡½æ•°å³å¯å£°æ˜ä¸€ä¸ªæ„é€ å‡½æ•°
- ï¼ˆå¯¹äºå‘½åå¼æ„é€ å‡½æ•° è¿˜å¯ä»¥æ·»åŠ é¢å¤–çš„æ ‡è¯†ç¬¦ï¼‰ã€‚
- å¤§éƒ¨åˆ†çš„æ„é€ å‡½æ•°å½¢å¼æ˜¯ç”Ÿæˆå¼æ„é€ å‡½æ•°ï¼Œ**å…¶ç”¨äºåˆ›å»ºä¸€ä¸ªç±»çš„å®ä¾‹**ã€‚

#### ç»ˆå€¼åˆå§‹åŒ–

Dart åˆ™æä¾›äº†ä¸€ç§ç‰¹æ®Šçš„è¯­æ³•ç³–æ¥ç®€åŒ–è¯¥æ­¥éª¤ã€‚
æ„é€ ä¸­åˆå§‹åŒ–çš„å‚æ•°å¯ä»¥ç”¨äºåˆå§‹åŒ–éç©ºæˆ– final ä¿®é¥°çš„å˜é‡ï¼Œå®ƒä»¬éƒ½å¿…é¡»è¢«åˆå§‹åŒ–æˆ–æä¾›ä¸€ä¸ªé»˜è®¤å€¼ã€‚

```dart
class Point {
  double x = 0;
  double y = 0;

/*
// ä½¿ç”¨ this å…³é”®å­—å¼•ç”¨å½“å‰å®ä¾‹
  Point(double x, double y) {
    this.x = x;
    this.y = y;
  }
  */
// è¯­æ³•ç³–æ–¹å¼
   Point(this.x, this.y);
}
```

#### é»˜è®¤æ„é€ å‡½æ•°

å¦‚æœä½ æ²¡æœ‰å£°æ˜æ„é€ å‡½æ•°ï¼Œé‚£ä¹ˆ Dart ä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªæ— å‚æ•°çš„æ„é€ å‡½æ•°å¹¶ä¸”è¯¥æ„é€ å‡½æ•°ä¼šè°ƒç”¨å…¶çˆ¶ç±»çš„æ— å‚æ•°æ„é€ æ–¹æ³•ã€‚

#### æ„é€ å‡½æ•°ä¸è¢«ç»§æ‰¿

å­ç±»ä¸ä¼šç»§æ‰¿çˆ¶ç±»çš„æ„é€ å‡½æ•°ï¼Œå¦‚æœå­ç±»æ²¡æœ‰å£°æ˜æ„é€ å‡½æ•°ï¼Œé‚£ä¹ˆåªä¼šæœ‰ä¸€ä¸ªé»˜è®¤æ— å‚æ•°çš„æ„é€ å‡½æ•°ã€‚

#### å‘½åå¼æ„é€ å‡½æ•°

å¯ä»¥ä¸ºä¸€ä¸ªç±»å£°æ˜å¤šä¸ªå‘½åå¼æ„é€ å‡½æ•°æ¥è¡¨è¾¾æ›´æ˜ç¡®çš„æ„å›¾ã€‚

```dart
const double xOrigin = 0;
const double yOrigin = 0;

class Point {
  double x = 0;
  double y = 0;

  Point(this.x, this.y);

  // Named constructor
  Point.origin()
      : x = xOrigin,
        y = yOrigin;
}
```

æ„é€ å‡½æ•°æ˜¯ä¸èƒ½è¢«ç»§æ‰¿çš„ï¼Œè¿™å°†æ„å‘³ç€å­ç±»ä¸èƒ½ç»§æ‰¿çˆ¶ç±»çš„å‘½åå¼æ„é€ å‡½æ•°ï¼Œ  
å¦‚æœä½ æƒ³åœ¨å­ç±»ä¸­æä¾›ä¸€ä¸ªä¸çˆ¶ç±»å‘½åæ„é€ å‡½æ•°åå­—ä¸€æ ·çš„å‘½åæ„é€ å‡½æ•°ï¼Œåˆ™éœ€è¦åœ¨å­ç±»ä¸­æ˜¾å¼åœ°å£°æ˜ã€‚

#### è°ƒç”¨çˆ¶ç±»éé»˜è®¤æ„é€ å‡½æ•°

**é»˜è®¤æƒ…å†µä¸‹ï¼Œå­ç±»çš„æ„é€ å‡½æ•°ä¼šè°ƒç”¨çˆ¶ç±»çš„åŒ¿åæ— å‚æ•°æ„é€ æ–¹æ³•**ï¼Œå¹¶ä¸”è¯¥è°ƒç”¨ä¼šåœ¨å­ç±»æ„é€ å‡½æ•°çš„å‡½æ•°ä½“ä»£ç æ‰§è¡Œå‰ï¼Œ  
å¦‚æœå­ç±»æ„é€ å‡½æ•°è¿˜æœ‰ä¸€ä¸ª åˆå§‹åŒ–åˆ—è¡¨ï¼Œé‚£ä¹ˆè¯¥åˆå§‹åŒ–åˆ—è¡¨ä¼šåœ¨è°ƒç”¨çˆ¶ç±»çš„è¯¥æ„é€ å‡½æ•°ä¹‹å‰è¢«æ‰§è¡Œï¼Œ  
æ€»çš„æ¥è¯´ï¼Œè¿™ä¸‰è€…çš„è°ƒç”¨é¡ºåºå¦‚ä¸‹ï¼š

- åˆå§‹åŒ–åˆ—è¡¨
- çˆ¶ç±»çš„æ— å‚æ•°æ„é€ å‡½æ•°
- å½“å‰ç±»çš„æ„é€ å‡½æ•°

**å¦‚æœçˆ¶ç±»æ²¡æœ‰åŒ¿åæ— å‚æ•°æ„é€ å‡½æ•°ï¼Œé‚£ä¹ˆå­ç±»å¿…é¡»è°ƒç”¨çˆ¶ç±»çš„å…¶ä¸­ä¸€ä¸ªæ„é€ å‡½æ•°ã€‚**

- _ä¸ºå­ç±»çš„æ„é€ å‡½æ•°æŒ‡å®šä¸€ä¸ªçˆ¶ç±»çš„æ„é€ å‡½æ•°åªéœ€åœ¨æ„é€ å‡½æ•°ä½“å‰ä½¿ç”¨ï¼ˆ:ï¼‰æŒ‡å®šã€‚_

```dart
class Person {
  String? firstName;

  Person.fromJson(Map data) {
    print('in Person');
  }
}

class Employee extends Person {
  // Person does not have a default constructor;
  // you must call super.fromJson(data).
  // ä¸ºå­ç±»çš„æ„é€ å‡½æ•°æŒ‡å®šä¸€ä¸ªçˆ¶ç±»çš„æ„é€ å‡½æ•°ï¼Œåœ¨å­ç±»æ„é€ å‡½æ•°åŠ ä¸ª ã€ï¼š çˆ¶ç±»æ„é€ å‡½æ•°ã€‘ å³å¯
  Employee.fromJson(Map data) : super.fromJson(data) {
    print('in Employee');
  }
}

void main() {
  var employee = Employee.fromJson({});
  print(employee);
  // Prints:
  // in Person
  // in Employee
  // Instance of 'Employee'
}
```

**è¯·æ³¨æ„:**

ä¼ é€’ç»™çˆ¶ç±»æ„é€ å‡½æ•°çš„å‚æ•°ä¸èƒ½ä½¿ç”¨ this å…³é”®å­—ã€‚

- å› ä¸ºåœ¨å‚æ•°ä¼ é€’çš„è¿™ä¸€æ­¥éª¤ï¼Œå­ç±»æ„é€ å‡½æ•°å°šæœªæ‰§è¡Œï¼Œå­ç±»çš„å®ä¾‹å¯¹è±¡ä¹Ÿå°±è¿˜æœªåˆå§‹åŒ–ï¼Œå› æ­¤æ‰€æœ‰çš„å®ä¾‹æˆå‘˜éƒ½ä¸èƒ½è¢«è®¿é—®ï¼Œä½†æ˜¯ç±»æˆå‘˜å¯ä»¥ã€‚

#### åˆå§‹åŒ–åˆ—è¡¨

é™¤äº†è°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•°ä¹‹å¤–ï¼Œè¿˜å¯ä»¥åœ¨æ„é€ å‡½æ•°ä½“æ‰§è¡Œä¹‹å‰åˆå§‹åŒ–å®ä¾‹å˜é‡ã€‚æ¯ä¸ªå®ä¾‹å˜é‡ä¹‹é—´ä½¿ç”¨é€—å·åˆ†éš”ã€‚

```dart
// Initializer list sets instance variables before
// the constructor body runs.
Point.fromJson(Map<String, double> json)
    : x = json['x']!,
      y = json['y']! {
  print('In Point.fromJson(): ($x, $y)');
}
```

**è¯·æ³¨æ„:**

åˆå§‹åŒ–åˆ—è¡¨è¡¨è¾¾å¼ = å³è¾¹çš„è¯­å¥ä¸èƒ½ä½¿ç”¨ this å…³é”®å­—ã€‚

```dart
// ä½¿ç”¨åˆå§‹åŒ–åˆ—è¡¨è®¾ç½® final å­—æ®µéå¸¸æ–¹ä¾¿ï¼Œä¸‹é¢çš„ç¤ºä¾‹ä¸­å°±ä½¿ç”¨åˆå§‹åŒ–åˆ—è¡¨æ¥è®¾ç½®äº†ä¸‰ä¸ª final å˜é‡çš„å€¼ã€‚
import 'dart:math';

class Point {
  final double x;
  final double y;
  final double distanceFromOrigin;

  Point(double x, double y)
      : x = x,
        y = y,
        distanceFromOrigin = sqrt(x * x + y * y);
}

void main() {
  var p = Point(2, 3);
  print(p.distanceFromOrigin);  // 3.605551275463989
}
```

#### é‡å®šå‘æ„é€ å‡½æ•°

æœ‰æ—¶å€™**ç±»ä¸­çš„æ„é€ å‡½æ•°ä»…ç”¨äºè°ƒç”¨ç±»ä¸­å…¶å®ƒçš„æ„é€ å‡½æ•°**ï¼Œ  
æ­¤æ—¶è¯¥æ„é€ å‡½æ•°æ²¡æœ‰å‡½æ•°ä½“ï¼Œåªéœ€**åœ¨å‡½æ•°ç­¾ååä½¿ç”¨ï¼ˆ:ï¼‰æŒ‡å®šéœ€è¦é‡å®šå‘åˆ°çš„å…¶å®ƒæ„é€ å‡½æ•° (ä½¿ç”¨ this è€Œéç±»å)**ï¼š

```dart
class Point {
  double x, y;

  // The main constructor for this class.
  Point(this.x, this.y);

  // Delegates to the main constructor.
  // å§”æ‰˜ç»™ä¸»æ„é€ å‡½æ•°ã€‚
  Point.alongXAxis(double x) : this(x, 0);
}
```

#### å¸¸é‡æ„é€ å‡½æ•°

å¦‚æœç±»ç”Ÿæˆçš„å¯¹è±¡éƒ½æ˜¯ä¸å˜çš„ï¼Œå¯ä»¥åœ¨ç”Ÿæˆè¿™äº›å¯¹è±¡æ—¶å°±å°†å…¶å˜ä¸ºç¼–è¯‘æ—¶å¸¸é‡ã€‚  
å¯ä»¥åœ¨ç±»çš„æ„é€ å‡½æ•°å‰åŠ ä¸Š const å…³é”®å­—å¹¶ç¡®ä¿æ‰€æœ‰å®ä¾‹å˜é‡å‡ä¸º final æ¥å®ç°è¯¥åŠŸèƒ½ã€‚

```dart
class ImmutablePoint {
  static const ImmutablePoint origin = ImmutablePoint(0, 0);

  final double x, y;

  const ImmutablePoint(this.x, this.y);
}
```

#### å·¥å‚æ„é€ å‡½æ•°

ä½¿ç”¨ `factory` å…³é”®å­—æ ‡è¯†ç±»çš„æ„é€ å‡½æ•°å°†ä¼šä»¤è¯¥æ„é€ å‡½æ•°å˜ä¸ºå·¥å‚æ„é€ å‡½æ•°ï¼Œè¿™å°†æ„å‘³ç€ä½¿ç”¨è¯¥æ„é€ å‡½æ•°æ„é€ ç±»çš„å®ä¾‹æ—¶å¹¶éæ€»æ˜¯ä¼šè¿”å›æ–°çš„å®ä¾‹å¯¹è±¡ã€‚

**åœ¨å·¥å‚æ„é€ å‡½æ•°ä¸­æ— æ³•è®¿é—® thisã€‚**

ä¾‹å¦‚ï¼Œå·¥å‚æ„é€ å‡½æ•°å¯èƒ½ä¼šä»ç¼“å­˜ä¸­è¿”å›ä¸€ä¸ªå®ä¾‹ï¼Œæˆ–è€…è¿”å›ä¸€ä¸ªå­ç±»å‹çš„å®ä¾‹ã€‚

```dart
class Logger {
  final String name;
  bool mute = false;

  // _cache æ˜¯ç§æœ‰å˜é‡ï¼Œå› ä¸ºå‰ç¼€ _ çš„ç¼˜æ•…ã€‚
  static final Map<String, Logger> _cache = <String, Logger>{};

 // Logger çš„å·¥å‚æ„é€ å‡½æ•°ä»ç¼“å­˜ä¸­è¿”å›å¯¹è±¡ï¼Œå’Œ Logger.fromJson å·¥å‚æ„é€ å‡½æ•°ä» JSON å¯¹è±¡ä¸­åˆå§‹åŒ–ä¸€ä¸ªæœ€ç»ˆå˜é‡ã€‚
  factory Logger(String name) {
    return _cache.putIfAbsent(
        name, () => Logger._internal(name));
  }

  factory Logger.fromJson(Map<String, Object> json) {
    return Logger(json['name'].toString());
  }

  Logger._internal(this.name);

  void log(String msg) {
    if (!mute) print(msg);
  }
}
```

### æ–¹æ³•(Methods)

æ–¹æ³•æ˜¯ä¸ºå¯¹è±¡æä¾›è¡Œä¸ºçš„å‡½æ•°(Methods are functions that provide behavior for an object.)ã€‚

#### å®ä¾‹æ–¹æ³•

å¯¹è±¡çš„å®ä¾‹æ–¹æ³•å¯ä»¥è®¿é—®å®ä¾‹å˜é‡å’Œ thisã€‚

```dart
import 'dart:math';

class Point {
  double x = 0;
  double y = 0;

  Point(this.x, this.y);

  // distanceTo() æ–¹æ³•å°±æ˜¯ä¸€ä¸ªå®ä¾‹æ–¹æ³•
  double distanceTo(Point other) {
    var dx = x - other.x;
    var dy = y - other.y;
    return sqrt(dx * dx + dy * dy);
  }
}
```

#### æ“ä½œç¬¦

è¿ç®—ç¬¦æ˜¯æœ‰ç€ç‰¹æ®Šåç§°çš„å®ä¾‹æ–¹æ³•ã€‚

Dart å…è®¸ä½¿ç”¨ä»¥ä¸‹åç§°å®šä¹‰è¿ç®—ç¬¦:
| | |||
| :----: | :----: |:----: |:----: |
|< |+| \| |>>>|
|> |/| ^ |[]|
|<= |~/| & |[]=|
|>= |\*| <<| ~|
|â€“ |%| >>| ==|

**ä¸ºäº†è¡¨ç¤ºé‡å†™æ“ä½œç¬¦ï¼Œä½¿ç”¨ `operator` æ ‡è¯†æ¥è¿›è¡Œæ ‡è®°ã€‚**

```dart
class Vector {
  final int x, y;

  Vector(this.x, this.y);

// æŠŠ+ - é‡å¯«ä¸ºå‘é‡çš„+ -
  Vector operator +(Vector v) => Vector(x + v.x, y + v.y);
  Vector operator -(Vector v) => Vector(x - v.x, y - v.y);

  // Operator == and hashCode not shown.
  // Â·Â·Â·
}

void main() {
  final v = Vector(2, 3);
  final w = Vector(2, 2);

  assert(v + w == Vector(4, 5));
  assert(v - w == Vector(0, 1));
}
```

#### Getter å’Œ Setter

- `Getter` å’Œ `Setter` æ˜¯ä¸€å¯¹ç”¨æ¥è¯»å†™å¯¹è±¡å±æ€§çš„ç‰¹æ®Šæ–¹æ³•ï¼Œ
- å®ä¾‹å¯¹è±¡çš„æ¯ä¸€ä¸ªå±æ€§éƒ½æœ‰ä¸€ä¸ªéšå¼çš„ `Getter` æ–¹æ³•ï¼Œå¦‚æœä¸ºé `final` å±æ€§çš„è¯è¿˜ä¼šæœ‰ä¸€ä¸ª Setter æ–¹æ³•ï¼Œ
- å¯ä»¥ä½¿ç”¨ `get` å’Œ `set` å…³é”®å­—ä¸ºé¢å¤–çš„å±æ€§æ·»åŠ  `Getter` å’Œ `Setter` æ–¹æ³•ã€‚
  - ä½¿ç”¨ `Getter` å’Œ `Setter` çš„å¥½å¤„æ˜¯ï¼Œä½ å¯ä»¥å…ˆä½¿ç”¨ä½ çš„å®ä¾‹å˜é‡ï¼Œè¿‡ä¸€æ®µæ—¶é—´è¿‡å†å°†å®ƒä»¬åŒ…è£¹æˆæ–¹æ³•ä¸”ä¸éœ€è¦æ”¹åŠ¨ä»»ä½•ä»£ç ï¼Œå³å…ˆå®šä¹‰åæ›´æ”¹ä¸”ä¸å½±å“åŸæœ‰é€»è¾‘ã€‚
  - åƒè‡ªå¢ï¼ˆ`++`ï¼‰è¿™æ ·çš„æ“ä½œç¬¦ä¸ç®¡æ˜¯å¦å®šä¹‰äº† `Getter` æ–¹æ³•éƒ½ä¼šæ­£ç¡®åœ°æ‰§è¡Œã€‚
  - ä¸ºäº†é¿å…ä¸€äº›ä¸å¿…è¦çš„å¼‚å¸¸æƒ…å†µï¼Œè¿ç®—ç¬¦åªä¼šè°ƒç”¨ `Getter` ä¸€æ¬¡ï¼Œç„¶åå°†å…¶å€¼å­˜å‚¨åœ¨ä¸€ä¸ªä¸´æ—¶å˜é‡ä¸­ã€‚

```dart
class Rectangle {
  double left, top, width, height;

  Rectangle(this.left, this.top, this.width, this.height);

  // Define two calculated properties: right and bottom.
  double get right => left + width;
  set right(double value) => left = value - width;
  double get bottom => top + height;
  set bottom(double value) => top = value - height;
}

void main() {
  var rect = Rectangle(3, 4, 20, 15);
  assert(rect.left == 3);
  rect.right = 12;
  assert(rect.left == -8);
}
```

#### æŠ½è±¡æ–¹æ³•

æŠ½è±¡æ–¹æ³•å°±æ˜¯ä»¥ abstract ä¿®é¥°çš„æ–¹æ³•ï¼Œè¿™ç§æ–¹æ³•åªå£°æ˜è¿”å›çš„æ•°æ®ç±»å‹ã€æ–¹æ³•åç§°å’Œæ‰€éœ€çš„å‚æ•°ï¼Œæ²¡æœ‰æ–¹æ³•ä½“ï¼Œä¹Ÿå°±æ˜¯è¯´**æŠ½è±¡æ–¹æ³•åªéœ€è¦å£°æ˜è€Œä¸éœ€è¦å®ç°**ã€‚

**å½“ä¸€ä¸ªæ–¹æ³•ä¸ºæŠ½è±¡æ–¹æ³•æ—¶ï¼Œæ„å‘³ç€è¿™ä¸ªæ–¹æ³•å¿…é¡»è¢«å­ç±»çš„æ–¹æ³•æ‰€é‡å†™ï¼Œå¦åˆ™å…¶å­ç±»çš„è¯¥æ–¹æ³•ä»ç„¶æ˜¯ abstract çš„**ï¼Œè€Œè¿™ä¸ªå­ç±»ä¹Ÿå¿…é¡»æ˜¯æŠ½è±¡çš„ï¼Œå³å£°æ˜ä¸º abstractã€‚

- å®ä¾‹æ–¹æ³•ã€Getter æ–¹æ³•ä»¥åŠ Setter æ–¹æ³•éƒ½å¯ä»¥æ˜¯æŠ½è±¡çš„ï¼Œ
- å®šä¹‰ä¸€ä¸ªæ¥å£æ–¹æ³•è€Œä¸å»åšå…·ä½“çš„å®ç°è®©å®ç°å®ƒçš„ç±»å»å®ç°è¯¥æ–¹æ³•ï¼Œ
- **æŠ½è±¡æ–¹æ³•åªèƒ½å­˜åœ¨äº*æŠ½è±¡ç±»*ä¸­**,
- ç›´æ¥ä½¿ç”¨åˆ†å·ï¼ˆ`;`ï¼‰æ›¿ä»£æ–¹æ³•ä½“å³å¯å£°æ˜ä¸€ä¸ªæŠ½è±¡æ–¹æ³•

```dart
abstract class Doer {
  // Define instance variables and methods...

  void doSomething(); // Define an abstract method.
}

class EffectiveDoer extends Doer {
  void doSomething() {
    // Provide an implementation, so the method is not abstract here...
  }
}
```

### æŠ½è±¡ç±»(Abstract classes)

- ä½¿ç”¨å…³é”®å­— `abstract` æ ‡è¯†ç±»å¯ä»¥è®©è¯¥ç±»æˆä¸º æŠ½è±¡ç±»ï¼Œ
- æŠ½è±¡ç±»å°†æ— æ³•è¢«å®ä¾‹åŒ–ã€‚
- æŠ½è±¡ç±»å¸¸ç”¨äºå£°æ˜æ¥å£æ–¹æ³•ã€æœ‰æ—¶ä¹Ÿä¼šæœ‰å…·ä½“çš„æ–¹æ³•å®ç°ã€‚
- å¦‚æœæƒ³è®©æŠ½è±¡ç±»åŒæ—¶å¯è¢«å®ä¾‹åŒ–ï¼Œå¯ä»¥ä¸ºå…¶å®šä¹‰ å·¥å‚æ„é€ å‡½æ•°ã€‚
- æŠ½è±¡ç±»å¸¸å¸¸ä¼šåŒ…å«æŠ½è±¡æ–¹æ³•ã€‚

```dart
// è¯¥ç±»è¢«å£°æ˜ä¸ºæŠ½è±¡ç±»ï¼Œå› æ­¤æ— æ³•å®ä¾‹åŒ–ã€‚
abstract class AbstractContainer {
  // Define constructors, fields, methods...

  void updateChildren(); // æŠ½è±¡æ–¹æ³•ã€‚
}
```

### éšå¼æ¥å£ï¼ˆImplicit interfacesï¼‰

- **æ¯ä¸€ä¸ªç±»éƒ½éšå¼åœ°å®šä¹‰äº†ä¸€ä¸ªæ¥å£å¹¶å®ç°äº†è¯¥æ¥å£ï¼Œè¿™ä¸ªæ¥å£åŒ…å«æ‰€æœ‰è¿™ä¸ªç±»çš„å®ä¾‹æˆå‘˜ä»¥åŠè¿™ä¸ªç±»æ‰€å®ç°çš„å…¶å®ƒæ¥å£ã€‚**
  - ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“æˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªç±»çš„æ—¶å€™ï¼ŒåŒæ—¶å°±ä¼šäº§ç”Ÿä¸€ä¸ªå’Œæ­¤ç±»åŒåçš„æ¥å£ï¼Œè€Œä¸”æ­¤æ¥å£åŒ…å«äº†æˆ‘ä»¬å®šä¹‰çš„ç±»ä¸­æ‰€æœ‰çš„æ–¹æ³•ï¼Œä»¥åŠå®ƒçš„æˆå‘˜å˜é‡ã€‚
- å¦‚æœæƒ³è¦åˆ›å»ºä¸€ä¸ª A ç±»æ”¯æŒè°ƒç”¨ B ç±»çš„ API ä¸”ä¸æƒ³ç»§æ‰¿ B ç±»ï¼Œåˆ™å¯ä»¥å®ç° B ç±»çš„æ¥å£ã€‚
- ä¸€ä¸ªç±»å¯ä»¥é€šè¿‡å…³é”®å­— `implements` æ¥**å®ç°ä¸€ä¸ªæˆ–å¤šä¸ªæ¥å£å¹¶å®ç°æ¯ä¸ªæ¥å£å®šä¹‰çš„ API**ã€‚
  - å¦‚æœéœ€è¦**å®ç°å¤šä¸ªç±»æ¥å£**ï¼Œå¯ä»¥ä½¿ç”¨é€—å·åˆ†å‰²æ¯ä¸ªæ¥å£ç±»ã€‚

```dart
/**
 * éšå¼æ¥å£
 *
 * åº“å’Œå¯è§æ€§(Libraries and visibility)è¯´æ˜ï¼š
 * import å’Œ library å…³é”®å­—å¯ä»¥å¸®åŠ©ä½ åˆ›å»ºä¸€ä¸ªæ¨¡å—åŒ–å’Œå¯å…±äº«çš„ä»£ç åº“ã€‚
 * ä»£ç åº“ä¸ä»…åªæ˜¯æä¾› API è€Œä¸”è¿˜èµ·åˆ°äº†å°è£…çš„ä½œç”¨ï¼šä»¥ä¸‹åˆ’çº¿ï¼ˆ_ï¼‰å¼€å¤´çš„æˆå‘˜ä»…åœ¨ä»£ç åº“ä¸­å¯è§ã€‚
 * æ¯ä¸ª Dart ç¨‹åºéƒ½æ˜¯ä¸€ä¸ªåº“ï¼Œå³ä¾¿æ²¡æœ‰ä½¿ç”¨å…³é”®å­— library æŒ‡å®šã€‚
 */

// Personç±»ï¼Œéšå¼æ¥å£ greet().
class Person {
  // åº“ä¸­å¯è§çš„ç§æœ‰å˜é‡ _name
  final String _name;

  // æ„é€ å‡½æ•°
  Person(this._name);

  // åº“ä¸­çš„æ–¹æ³•
  String greet(String who) => 'Hello, $who. I am $_name.';
}

// An implementation of the Person interface.Personæ¥å£çš„å®ç°ã€‚
class Impostor implements Person {
  String get _name => '';
  String greet(String who) => 'Hi $who. Do you know who I am?';
}

String greetBob(Person person) => person.greet('Bob');

void main() {
  var p = Person('å¼ ä¸‰'); // å¼ ä¸‰
  print(p._name);
  print(p.greet("æå››")); // Hello, æå››. I am å¼ ä¸‰.

  print(greetBob(Person('Kathy'))); // Hello, Bob. I am Kathy.
  print(greetBob(Impostor())); // Hi Bob. Do you know who I am?
}
```

### æ‰©å±•ï¼ˆextendsã€ç»§æ‰¿ï¼‰ä¸€ä¸ªç±»

**Dart æ”¯æŒå•ç»§æ‰¿ã€‚**

ä½¿ç”¨ extends å…³é”®å­—æ¥åˆ›å»ºä¸€ä¸ªå­ç±»ï¼Œå¹¶å¯ä½¿ç”¨ super å…³é”®å­—å¼•ç”¨ä¸€ä¸ªçˆ¶ç±»

```dart
class Television {
  void turnOn() {
    _illuminateDisplay();
    _activateIrSensor();
  }
  // Â·Â·Â·
}

class SmartTelevision extends Television {
  void turnOn() {
    super.turnOn();
    _bootNetworkInterface();
    _initializeMemory();
    _upgradeApps();
  }
  // Â·Â·Â·
}
```

#### é‡å†™(override)ç±»æˆå‘˜

- å­ç±»å¯ä»¥é‡å†™çˆ¶ç±»çš„å®ä¾‹æ–¹æ³•ï¼ˆåŒ…æ‹¬ æ“ä½œç¬¦ï¼‰ã€ Getter ä»¥åŠ Setter æ–¹æ³•ã€‚
  - å¯ä»¥ä½¿ç”¨ `@override` æ³¨è§£æ¥è¡¨ç¤ºä½ é‡å†™äº†ä¸€ä¸ªæˆå‘˜.
- ä¸€ä¸ªé‡å†™æ–¹æ³•çš„å£°æ˜å¿…é¡»åœ¨å‡ ä¸ªæ–¹é¢ä¸å®ƒæ‰€é‡æ–°çš„æ–¹æ³•ï¼ˆæˆ–æ–¹æ³•ï¼‰ç›¸åŒ¹é…:
  - **è¿”å›ç±»å‹**å¿…é¡»ä¸è¢«é‡å†™æ–¹æ³•çš„è¿”å›ç±»å‹ç›¸åŒï¼ˆæˆ–ä¸ºå…¶å­ç±»å‹ï¼‰ã€‚
  - **å‚æ•°ç±»å‹**å¿…é¡»ä¸è¢«é‡å†™æ–¹æ³•çš„å‚æ•°ç±»å‹ç›¸åŒï¼ˆæˆ–è€…æ˜¯è¶…ç±»å‹ï¼‰ã€‚
  - å¦‚æœè¢«é‡å†™çš„æ–¹æ³•æ¥å— **n ä¸ªä½ç½®å‚æ•°**ï¼Œé‚£ä¹ˆè¢«é‡å†™çš„æ–¹æ³•ä¹Ÿå¿…é¡»æ¥å— n ä¸ªä½ç½®å‚æ•°ã€‚
  - ä¸€ä¸ªæ³›å‹æ–¹æ³•ä¸èƒ½é‡å†™ä¸€ä¸ªéæ³›å‹æ–¹æ³•ï¼Œè€Œä¸€ä¸ªéæ³›å‹æ–¹æ³•ä¹Ÿä¸èƒ½é‡å†™ä¸€ä¸ªæ³›å‹æ–¹æ³•ã€‚
- **æ³¨æ„ï¼šå¦‚æœé‡å†™ `==` æ“ä½œç¬¦ï¼Œå¿…é¡»åŒæ—¶é‡å†™å¯¹è±¡ hashCode çš„ Getter æ–¹æ³•ã€‚**
- å¯ä»¥ä½¿ç”¨ `covariant` å…³é”®å­— æ¥ç¼©å°ä»£ç ä¸­é‚£äº›ç¬¦åˆ `ç±»å‹å®‰å…¨` çš„æ–¹æ³•å‚æ•°æˆ–å®ä¾‹å˜é‡çš„ç±»å‹ã€‚

```dart
class Television {
  // Â·Â·Â·
  set contrast(int value) {...}
}

class SmartTelevision extends Television {
  @override
  set contrast(num value) {...}
  // Â·Â·Â·
}
```

#### noSuchMethod æ–¹æ³•

å¦‚æœè°ƒç”¨äº†å¯¹è±¡ä¸Šä¸å­˜åœ¨çš„æ–¹æ³•æˆ–å®ä¾‹å˜é‡å°†ä¼šè§¦å‘ `noSuchMethod` æ–¹æ³•ã€‚

å¯ä»¥é‡å†™ `noSuchMethod` æ–¹æ³•æ¥è¿½è¸ªå’Œè®°å½•è¿™ä¸€è¡Œä¸ºã€‚

```dart
class A {
  // é™¤éé‡å†™noSuchMethodï¼Œå¦åˆ™ä½¿ç”¨ä¸å­˜åœ¨çš„æˆå‘˜ä¼šå¯¼è‡´NoSuchMethodErrorã€‚
  @override
  void noSuchMethod(Invocation invocation) {
    print('You tried to use a non-existent member: '
        '${invocation.memberName}');
  }
}
```

**åªæœ‰ä¸‹é¢å…¶ä¸­ä¸€ä¸ªæ¡ä»¶æˆç«‹æ—¶ï¼Œä½ æ‰èƒ½è°ƒç”¨ä¸€ä¸ªæœªå®ç°çš„(unimplemented)æ–¹æ³•ï¼š**

- æ¥æ”¶æ–¹(receiver)æ˜¯é™æ€çš„ `dynamic` ç±»å‹ã€‚
- æ¥æ”¶æ–¹(receiver)å…·æœ‰é™æ€ç±»å‹ï¼Œå®šä¹‰äº†æœªå®ç°çš„æ–¹æ³•ï¼ˆæŠ½è±¡äº¦å¯ï¼‰ï¼Œå¹¶ä¸”æ¥æ”¶æ–¹çš„åŠ¨æ€ç±»å‹å®ç°äº† `noSuchMethod` æ–¹æ³•ä¸”å…·ä½“çš„å®ç°ä¸ `Object` ä¸­çš„ä¸åŒã€‚

### æ‰©å±•æ–¹æ³•(Extension methods)

**æ‰©å±•æ–¹æ³•æ˜¯å‘ç°æœ‰åº“æ·»åŠ åŠŸèƒ½çš„ä¸€ç§æ–¹å¼ã€‚** å¯èƒ½å·²ç»åœ¨ä¸çŸ¥é“å®ƒæ˜¯æ‰©å±•æ–¹æ³•çš„æƒ…å†µä¸‹ä½¿ç”¨äº†å®ƒã€‚

[Extension methods](https://dart.dev/guides/language/extension-methods)

### æšä¸¾ç±»å‹

æšä¸¾ç±»å‹æ˜¯ä¸€ç§ç‰¹æ®Šçš„ç±»å‹ï¼Œä¹Ÿç§°ä¸º `enumerations` æˆ– `enums`ï¼Œç”¨äºå®šä¹‰ä¸€äº›å›ºå®šæ•°é‡çš„å¸¸é‡å€¼ã€‚

#### ä½¿ç”¨æšä¸¾

- ä½¿ç”¨å…³é”®å­— `enum` æ¥å®šä¹‰æšä¸¾ç±»å‹
  - å¯ä»¥åœ¨å£°æ˜æšä¸¾ç±»å‹æ—¶ä½¿ç”¨ å°¾éšé€—å·(æœ€åä¸€ä¸ªå€¼åé¢åŠ äº†é€—å·)
- æ¯ä¸€ä¸ªæšä¸¾å€¼éƒ½æœ‰ä¸€ä¸ªåä¸º `index` æˆå‘˜å˜é‡çš„ `Getter` æ–¹æ³•ï¼Œè¯¥æ–¹æ³•å°†ä¼šè¿”å›ä»¥ `0` ä¸ºåŸºå‡†ç´¢å¼•çš„ä½ç½®å€¼ã€‚
- æƒ³è¦è·å¾—å…¨éƒ¨çš„æšä¸¾å€¼ï¼Œä½¿ç”¨æšä¸¾ç±»çš„ `values` æ–¹æ³•è·å–åŒ…å«å®ƒä»¬çš„åˆ—è¡¨ã€‚
- å¯ä»¥åœ¨ `Switch` è¯­å¥ä¸­ä½¿ç”¨æšä¸¾
  - ä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯å¿…é¡»å¤„ç†æšä¸¾å€¼çš„æ¯ä¸€ç§æƒ…å†µï¼Œå³æ¯ä¸€ä¸ªæšä¸¾å€¼éƒ½å¿…é¡»æˆä¸ºä¸€ä¸ª case å­å¥ï¼Œä¸ç„¶ä¼šå‡ºç°è­¦å‘Šã€‚

```dart
enum Color { red, green, blue }

var aColor = Color.blue;

switch (aColor) {
  case Color.red:
    print('Red as roses!');
    break;
  case Color.green:
    print('Green as grass!');
    break;
  default: // Without this, you see a WARNING.
    print(aColor); // 'Color.blue'
}
```

**æšä¸¾ç±»å‹æœ‰å¦‚ä¸‹ä¸¤ä¸ªé™åˆ¶**ï¼š

- æšä¸¾ä¸èƒ½æˆä¸ºå­ç±»ï¼Œä¹Ÿä¸å¯ä»¥ `mix in`ï¼Œä½ ä¹Ÿä¸å¯ä»¥å®ç°ä¸€ä¸ªæšä¸¾ã€‚
- ä¸èƒ½æ˜¾å¼åœ°å®ä¾‹åŒ–ä¸€ä¸ªæšä¸¾ç±»ã€‚

### ä½¿ç”¨ Mixin ä¸ºç±»æ·»åŠ åŠŸèƒ½

Mixin æ˜¯ä¸€ç§åœ¨å¤šé‡ç»§æ‰¿ä¸­å¤ç”¨æŸä¸ªç±»ä¸­ä»£ç çš„æ–¹æ³•æ¨¡å¼ã€‚  
ï¼ˆdart æ˜¯å•ç»§æ‰¿å¤šå®ç°ï¼Œä½¿ç”¨ mixin å¯ä»¥å¤šé‡ç»§æ‰¿ï¼‰

ä½¿ç”¨ `with` å…³é”®å­—å¹¶åœ¨å…¶åè·Ÿä¸Š Mixin ç±»çš„åå­—æ¥ä½¿ç”¨ Mixin æ¨¡å¼

```dart
class Musician extends Performer with Musical {
  // Â·Â·Â·
}

class Maestro extends Person with Musical, Aggressive, Demented {
  Maestro(String maestroName) {
    name = maestroName;
    canConduct = true;
  }
}
```

æƒ³è¦å®ç°ä¸€ä¸ª Mixinï¼Œè¯·åˆ›å»º**ä¸€ä¸ªç»§æ‰¿è‡ª `Object` ä¸”æœªå£°æ˜æ„é€ å‡½æ•°çš„ç±»**ã€‚

- é™¤éæƒ³è®©è¯¥ç±»ä¸æ™®é€šçš„ç±»ä¸€æ ·å¯ä»¥è¢«æ­£å¸¸åœ°ä½¿ç”¨ï¼Œå¦åˆ™è¯·ä½¿ç”¨å…³é”®å­— `mixin` æ›¿ä»£ `class`ã€‚

```dart
mixin Musical {
  bool canPlayPiano = false;
  bool canCompose = false;
  bool canConduct = false;

  void entertainMe() {
    if (canPlayPiano) {
      print('Playing piano');
    } else if (canConduct) {
      print('Waving hands');
    } else {
      print('Humming to self');
    }
  }
}
```

å¯ä»¥ä½¿ç”¨å…³é”®å­— `on` æ¥æŒ‡å®šå“ªäº›ç±»å¯ä»¥ä½¿ç”¨è¯¥ `Mixin` ç±»ã€‚

```dart
// åªæœ‰æ‰©å±•æˆ–å®ç°Musicianç±»çš„ç±»æ‰èƒ½ä½¿ç”¨MusicalPerformerè¿™ä¸ªæ··åˆå™¨(mixin)ã€‚
// å› ä¸ºSingerDanceræ‰©å±•(extends)äº†Musicianï¼Œæ‰€ä»¥SingerDancerå¯ä»¥æ··å…¥MusicalPerformerã€‚
class Musician {
  // ...
}
mixin MusicalPerformer on Musician {
  // ...
}
class SingerDancer extends Musician with MusicalPerformer {
  // ...
}
```

### ç±»å˜é‡å’Œæ–¹æ³•(Class variables and methods)

ä½¿ç”¨å…³é”®å­— `static` å¯ä»¥å£°æ˜ç±»å˜é‡æˆ–ç±»æ–¹æ³•(é™æ€å˜é‡æˆ–é™æ€æ–¹æ³•)ã€‚

#### é™æ€å˜é‡

é™æ€å˜é‡ï¼ˆå³ç±»å˜é‡ï¼‰å¸¸ç”¨äºå£°æ˜ç±»èŒƒå›´å†…æ‰€å±çš„çŠ¶æ€å˜é‡å’Œå¸¸é‡ã€‚  
**é™æ€å˜é‡åœ¨å…¶é¦–æ¬¡è¢«ä½¿ç”¨çš„æ—¶å€™æ‰è¢«åˆå§‹åŒ–**ã€‚

```dart
class Queue {
  static const initialCapacity = 16;
  // Â·Â·Â·
}

void main() {
  assert(Queue.initialCapacity == 16);
}
```

#### é™æ€æ–¹æ³•

é™æ€æ–¹æ³•ï¼ˆå³ç±»æ–¹æ³•ï¼‰ä¸èƒ½å¯¹å®ä¾‹è¿›è¡Œæ“ä½œï¼Œå› æ­¤ä¸èƒ½ä½¿ç”¨ `this`ã€‚ä½†æ˜¯ä»–ä»¬å¯ä»¥è®¿é—®é™æ€å˜é‡ã€‚

å¯ä»¥å°†é™æ€æ–¹æ³•ä½œä¸ºç¼–è¯‘æ—¶å¸¸é‡ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥å°†é™æ€æ–¹æ³•ä½œä¸ºä¸€ä¸ªå‚æ•°ä¼ é€’ç»™ä¸€ä¸ªå¸¸é‡æ„é€ å‡½æ•°ã€‚

```dart
import 'dart:math';

class Point {
  double x, y;
  Point(this.x, this.y);

  static double distanceBetween(Point a, Point b) {
    var dx = a.x - b.x;
    var dy = a.y - b.y;
    return sqrt(dx * dx + dy * dy);
  }
}

void main() {
  var a = Point(2, 2);
  var b = Point(4, 4);
    // å¯ä»¥åœ¨ä¸€ä¸ªç±»ä¸Šç›´æ¥è°ƒç”¨é™æ€æ–¹æ³•
  var distance = Point.distanceBetween(a, b);
  assert(2.8 < distance && distance < 2.9);
  print(distance);
}
```

## (ä¸ƒ) æ³›å‹

å¦‚æœæŸ¥çœ‹æ•°ç»„çš„ API æ–‡æ¡£ï¼Œä¼šå‘ç°æ•°ç»„ `List` çš„å®é™…ç±»å‹ä¸º` List<E>`ã€‚

- `<â€¦>` ç¬¦å·è¡¨ç¤ºæ•°ç»„æ˜¯ä¸€ä¸ª `æ³›å‹(generic)`ï¼ˆæˆ– `å‚æ•°åŒ–ç±»å‹(parameterized)ï¼‰`, **é€šå¸¸ä½¿ç”¨ä¸€ä¸ªå­—æ¯æ¥ä»£è¡¨ç±»å‹å‚æ•°**ï¼Œæ¯”å¦‚ Eã€Tã€Sã€K å’Œ V ç­‰ç­‰ã€‚

### ä¸ºä»€ä¹ˆä½¿ç”¨æ³›å‹ï¼Ÿ

æ³›å‹å¸¸ç”¨äºéœ€è¦è¦æ±‚ç±»å‹å®‰å…¨çš„æƒ…å†µï¼Œä½†æ˜¯å®ƒä¹Ÿä¼šå¯¹ä»£ç è¿è¡Œæœ‰å¥½å¤„ï¼š

- é€‚å½“åœ°æŒ‡å®šæ³›å‹å¯ä»¥æ›´å¥½åœ°å¸®åŠ©ä»£ç ç”Ÿæˆã€‚
- ä½¿ç”¨æ³›å‹å¯ä»¥å‡å°‘ä»£ç é‡å¤ã€‚

### ä½¿ç”¨é›†åˆå­—é¢é‡(Using collection literals)

Listã€Set ä»¥åŠ Map å­—é¢é‡ä¹Ÿå¯ä»¥æ˜¯å‚æ•°åŒ–çš„ã€‚

- å®šä¹‰å‚æ•°åŒ–çš„ List åªéœ€åœ¨ä¸­æ‹¬å·å‰æ·»åŠ  `<type>`ï¼›
- å®šä¹‰å‚æ•°åŒ–çš„ Map åªéœ€è¦åœ¨å¤§æ‹¬å·å‰æ·»åŠ  `<keyType, valueType>`ï¼š

```dart
var names = <String>['Seth', 'Kathy', 'Lars'];
var uniqueNames = <String>{'Seth', 'Kathy', 'Lars'};
var pages = <String, String>{
  'index.html': 'Homepage',
  'robots.txt': 'Hints for web robots',
  'humans.txt': 'We are people, not machines'
};
```

### ä½¿ç”¨ç±»å‹å‚æ•°åŒ–çš„æ„é€ å‡½æ•°

è°ƒç”¨æ„é€ æ–¹æ³•æ—¶ä¹Ÿå¯ä»¥ä½¿ç”¨æ³›å‹ï¼Œåªéœ€åœ¨ç±»ååç”¨å°–æ‹¬å·ï¼ˆ`<...>`ï¼‰å°†ä¸€ä¸ªæˆ–å¤šä¸ªç±»å‹åŒ…è£¹å³å¯ï¼š

```dart
var nameSet = Set<String>.from(names);
// ä¸‹é¢ä»£ç åˆ›å»ºäº†ä¸€ä¸ªé”®ä¸º Int ç±»å‹ï¼Œå€¼ä¸º View ç±»å‹çš„ Map å¯¹è±¡ï¼š
var views = Map<int, View>();
```

### æ³›å‹é›†åˆä»¥åŠå®ƒä»¬æ‰€åŒ…å«çš„ç±»å‹

Dart çš„æ³›å‹ç±»å‹æ˜¯ **å›ºåŒ–çš„(reified)**ï¼Œè¿™æ„å‘³ç€å³ä¾¿åœ¨è¿è¡Œæ—¶ä¹Ÿä¼šä¿æŒç±»å‹ä¿¡æ¯ã€‚

```dart
var names = <String>[];
names.addAll(['Seth', 'Kathy', 'Lars']);
print(names is List<String>); // true
```

> ä¸ Java ä¸åŒçš„æ˜¯ï¼ŒJava ä¸­çš„æ³›å‹æ˜¯ç±»å‹ **æ“¦é™¤(erasure)** çš„ï¼Œè¿™æ„å‘³ç€æ³›å‹ç±»å‹ä¼šåœ¨è¿è¡Œæ—¶è¢«ç§»é™¤ã€‚åœ¨ Java ä¸­ä½ å¯ä»¥åˆ¤æ–­å¯¹è±¡æ˜¯å¦ä¸º List ä½†ä¸å¯ä»¥åˆ¤æ–­å¯¹è±¡æ˜¯å¦ä¸º `List<String>`ã€‚

### é™åˆ¶å‚æ•°åŒ–ç±»å‹

æœ‰æ—¶**ä½¿ç”¨æ³›å‹**çš„æ—¶å€™ï¼Œå¯èƒ½ä¼šæƒ³**é™åˆ¶å¯ä½œä¸ºå‚æ•°çš„æ³›å‹èŒƒå›´**ï¼Œä¹Ÿå°±æ˜¯å‚æ•°å¿…é¡»æ˜¯æŒ‡å®šç±»å‹çš„å­ç±»ï¼Œè¿™æ—¶å€™**å¯ä»¥ä½¿ç”¨ `extends` å…³é”®å­—**ã€‚

- ä¸€ç§å¸¸è§çš„éç©ºç±»å‹å¤„ç†æ–¹å¼ï¼Œæ˜¯å°†å­ç±»é™åˆ¶ç»§æ‰¿ `Object` ï¼ˆè€Œä¸æ˜¯é»˜è®¤çš„ `Object?`ï¼‰ã€‚
- é™¤äº†å¯¹è±¡ä¹‹å¤–ï¼Œè¿˜å¯ä»¥å°†æ‰©å±•ä¸å…¶ä»–ç±»å‹ä¸€èµ·ä½¿ç”¨ã€‚

```dart
// å­ç±»é™åˆ¶ç»§æ‰¿ `Object`
class Foo<T extends Object> {
  // Any type provided to Foo for T must be non-nullable.
}
// ä¸‹é¢æ˜¯ä¸€ä¸ªæ‰©å±•SomeBaseClassçš„ç¤ºä¾‹ï¼Œä»¥ä¾¿å¯ä»¥åœ¨Tç±»å‹çš„å¯¹è±¡ä¸Šè°ƒç”¨SomeBaseClassçš„æˆå‘˜
class Foo<T extends SomeBaseClass> {
  // Implementation goes here...
  String toString() => "Instance of 'Foo<$T>'";
}
class Extender extends SomeBaseClass {...}

// è¿™æ—¶å€™å°±å¯ä»¥ä½¿ç”¨ SomeBaseClass æˆ–è€…å®ƒçš„å­ç±»æ¥ä½œä¸ºæ³›å‹å‚æ•°ï¼š
var someBaseClassFoo = Foo<SomeBaseClass>();
var extenderFoo = Foo<Extender>();
```

### ä½¿ç”¨æ³›å‹æ–¹æ³•

èµ·åˆ Dart åªæ”¯æŒåœ¨ç±»çš„å£°æ˜æ—¶æŒ‡å®šæ³›å‹ï¼Œç°åœ¨åŒæ ·ä¹Ÿå¯ä»¥åœ¨æ–¹æ³•ä¸Šä½¿ç”¨æ³›å‹ï¼Œç§°ä¹‹ä¸º æ³›å‹æ–¹æ³•(generic methods)ã€‚

```dart
T first<T>(List<T> ts) {
  // Do some initial work or error checking, then...
  T tmp = ts[0];
  // Do some additional checking or processing...
  return tmp;
}
/*
æ–¹æ³• first<T> çš„æ³›å‹ T å¯ä»¥åœ¨å¦‚ä¸‹åœ°æ–¹ä½¿ç”¨ï¼š
    å‡½æ•°çš„è¿”å›å€¼ç±»å‹ (T)ã€‚
    å‚æ•°çš„ç±»å‹ (List<T>)ã€‚
    å±€éƒ¨å˜é‡çš„ç±»å‹ (T tmp)ã€‚
*/
```

## (å…«) åº“å’Œå¯è§æ€§(Libraries and visibility)

`import` å’Œ `library` å…³é”®å­—å¯ä»¥å¸®åŠ©ä½ åˆ›å»ºä¸€ä¸ªæ¨¡å—åŒ–å’Œå¯å…±äº«çš„ä»£ç åº“ã€‚  
ä»£ç åº“ä¸ä»…åªæ˜¯æä¾› API è€Œä¸”è¿˜èµ·åˆ°äº†å°è£…çš„ä½œç”¨ï¼šä»¥ä¸‹åˆ’çº¿ï¼ˆ\_ï¼‰å¼€å¤´çš„æˆå‘˜ä»…åœ¨ä»£ç åº“ä¸­å¯è§ã€‚  
æ¯ä¸ª Dart ç¨‹åºéƒ½æ˜¯ä¸€ä¸ªåº“ï¼Œå³ä¾¿æ²¡æœ‰ä½¿ç”¨å…³é”®å­— library æŒ‡å®šã€‚  
Dart çš„åº“å¯ä»¥ä½¿ç”¨ åŒ…å·¥å…·(packages) æ¥å‘å¸ƒå’Œéƒ¨ç½²ã€‚

### ä½¿ç”¨åº“

ä½¿ç”¨ `import` æ¥æŒ‡å®šå‘½åç©ºé—´ä»¥ä¾¿å…¶å®ƒåº“å¯ä»¥è®¿é—®ã€‚

- import çš„å”¯ä¸€å‚æ•°æ˜¯ç”¨äºæŒ‡å®šä»£ç åº“çš„ URIï¼Œ
  - å¯¹äº Dart å†…ç½®çš„åº“ï¼Œä½¿ç”¨ `dart:xxxxxx` çš„å½¢å¼ã€‚
  - è€Œå¯¹äºå…¶å®ƒçš„åº“ï¼Œä½ å¯ä»¥ä½¿ç”¨ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿè·¯å¾„æˆ–è€…ä»¥ `package:xxxxxx` çš„å½¢å¼ã€‚
    - `package:xxxxxx` æŒ‡å®šçš„åº“é€šè¿‡åŒ…ç®¡ç†å™¨ï¼ˆæ¯”å¦‚ pub å·¥å…·ï¼‰æ¥æä¾›

```dart
import 'dart:html';
import 'package:test/test.dart';
```

URI ä»£è¡¨ç»Ÿä¸€èµ„æºæ ‡è¯†ç¬¦ã€‚  
URLï¼ˆç»Ÿä¸€èµ„æºå®šä½ç¬¦ï¼‰æ˜¯ä¸€ç§å¸¸è§çš„ URIã€‚

### æŒ‡å®šåº“å‰ç¼€

å¦‚æœå¯¼å…¥çš„ä¸¤ä¸ªä»£ç åº“æœ‰å†²çªçš„æ ‡è¯†ç¬¦ï¼Œå¯ä»¥ä¸ºå…¶ä¸­ä¸€ä¸ªæŒ‡å®šå‰ç¼€ã€‚

```dart
// æ¯”å¦‚å¦‚æœ library1 å’Œ library2 éƒ½æœ‰ Element ç±»
import 'package:lib1/lib1.dart';
import 'package:lib2/lib2.dart' as lib2;

// Uses Element from lib1.
Element element1 = Element();

// Uses Element from lib2.
lib2.Element element2 = lib2.Element();
```

### å¯¼å…¥åº“çš„ä¸€éƒ¨åˆ†

å¦‚æœåªæƒ³ä½¿ç”¨ä»£ç åº“ä¸­çš„ä¸€éƒ¨åˆ†ï¼Œå¯ä»¥æœ‰é€‰æ‹©åœ°å¯¼å…¥ä»£ç åº“ã€‚å…³é”®å­— `show` å’Œ `hide`ã€‚

```dart
// Import only foo.
import 'package:lib1/lib1.dart' show foo;

// Import all names EXCEPT foo.
import 'package:lib2/lib2.dart' hide foo;
```

### å»¶è¿ŸåŠ è½½(æ‡’åŠ è½½)åº“

å¯èƒ½ä½¿ç”¨åˆ°å»¶è¿ŸåŠ è½½çš„åœºæ™¯ï¼š

- ä¸ºäº†å‡å°‘åº”ç”¨çš„åˆå§‹åŒ–æ—¶é—´ã€‚
- å¤„ç† A/B æµ‹è¯•ï¼Œæ¯”å¦‚æµ‹è¯•å„ç§ç®—æ³•çš„ä¸åŒå®ç°ã€‚
- åŠ è½½å¾ˆå°‘ä¼šä½¿ç”¨åˆ°çš„åŠŸèƒ½ï¼Œæ¯”å¦‚å¯é€‰çš„å±å¹•å’Œå¯¹è¯æ¡†ã€‚

ä½¿ç”¨ `deferred as` å…³é”®å­—æ¥æ ‡è¯†éœ€è¦å»¶æ—¶åŠ è½½çš„ä»£ç åº“ã€‚  
å½“å®é™…éœ€è¦ä½¿ç”¨åˆ°åº“ä¸­ API æ—¶å…ˆè°ƒç”¨ `loadLibrary` å‡½æ•°åŠ è½½åº“ã€‚

- `loadLibrary` å‡½æ•°å¯ä»¥è°ƒç”¨å¤šæ¬¡ä¹Ÿæ²¡å…³ç³»ï¼Œä»£ç åº“åªä¼šè¢«åŠ è½½ä¸€æ¬¡ã€‚

```dart
import 'package:greetings/hello.dart' deferred as hello;

Future<void> greet() async {
  // ä½¿ç”¨ await å…³é”®å­—æš‚åœä»£ç æ‰§è¡Œç›´åˆ°åº“åŠ è½½å®Œæˆã€‚
  await hello.loadLibrary();
  hello.printGreeting();
}
```

å»¶è¿ŸåŠ è½½æ³¨æ„äº‹é¡¹ï¼š

- å»¶è¿ŸåŠ è½½çš„ä»£ç åº“ä¸­çš„å¸¸é‡éœ€è¦åœ¨ä»£ç åº“è¢«åŠ è½½çš„æ—¶å€™æ‰ä¼šå¯¼å…¥ï¼ŒæœªåŠ è½½æ—¶æ˜¯ä¸ä¼šå¯¼å…¥çš„ã€‚
- å¯¼å…¥æ–‡ä»¶çš„æ—¶å€™æ— æ³•ä½¿ç”¨å»¶è¿ŸåŠ è½½åº“ä¸­çš„ç±»å‹ã€‚å¦‚æœä½ éœ€è¦ä½¿ç”¨ç±»å‹ï¼Œåˆ™è€ƒè™‘æŠŠæ¥å£ç±»å‹è½¬ç§»åˆ°å¦ä¸€ä¸ªåº“ä¸­ç„¶åè®©ä¸¤ä¸ªåº“éƒ½åˆ†åˆ«å¯¼å…¥è¿™ä¸ªæ¥å£åº“ã€‚
- Dart ä¼šéšå¼åœ°å°† `loadLibrary()` å¯¼å…¥åˆ°ä½¿ç”¨äº† `deferred as` å‘½åç©ºé—´ çš„ç±»ä¸­ã€‚ `loadLibrary()` å‡½æ•°è¿”å›çš„æ˜¯ä¸€ä¸ª `Future`ã€‚

[å®ç°åº“](https://dart.cn/guides/libraries/create-library-packages)

## (ä¹) å¼‚æ­¥æ”¯æŒ(Asynchrony support)

Dart ä»£ç åº“ä¸­æœ‰å¤§é‡è¿”å› `Future` æˆ– `Stream` å¯¹è±¡çš„å‡½æ•°ï¼Œè¿™äº›å‡½æ•°éƒ½æ˜¯ å¼‚æ­¥ çš„ï¼Œå®ƒä»¬ä¼šåœ¨è€—æ—¶æ“ä½œï¼ˆæ¯”å¦‚ I/Oï¼‰æ‰§è¡Œå®Œæ¯•å‰ç›´æ¥è¿”å›è€Œä¸ä¼šç­‰å¾…è€—æ—¶æ“ä½œæ‰§è¡Œå®Œæ¯•ã€‚

`async` å’Œ `await` å…³é”®å­—ç”¨äºå®ç°å¼‚æ­¥ç¼–ç¨‹ï¼Œå¹¶ä¸”è®©ä»£ç çœ‹èµ·æ¥å°±åƒæ˜¯åŒæ­¥çš„ä¸€æ ·ã€‚

### å¤„ç† Future

å¯ä»¥é€šè¿‡ä¸‹é¢ä¸¤ç§æ–¹å¼ï¼Œè·å¾— Future æ‰§è¡Œå®Œæˆçš„ç»“æœï¼š

- ä½¿ç”¨ `async` å’Œ `await`;
- ä½¿ç”¨ `Future API`.

ä½¿ç”¨ `async` å’Œ `await` çš„**ä»£ç æ˜¯å¼‚æ­¥**çš„ï¼Œä½†æ˜¯**çœ‹èµ·æ¥æœ‰ç‚¹åƒåŒæ­¥ä»£ç **ã€‚

- å¿…é¡»åœ¨å¸¦æœ‰ `async` å…³é”®å­—çš„ **å¼‚æ­¥å‡½æ•°** ä¸­ä½¿ç”¨ `await`ã€‚

```dart
Future<void> checkVersion() async {
  var version = await lookUpVersion();
  // Do something with version
}
```

> å°½ç®¡å¼‚æ­¥å‡½æ•°å¯ä»¥å¤„ç†è€—æ—¶æ“ä½œï¼Œä½†æ˜¯å®ƒå¹¶ä¸ä¼šç­‰å¾…è¿™äº›è€—æ—¶æ“ä½œå®Œæˆï¼Œå¼‚æ­¥å‡½æ•°æ‰§è¡Œæ—¶ä¼šåœ¨å…¶é‡åˆ°ç¬¬ä¸€ä¸ª `await` è¡¨è¾¾å¼ï¼ˆä»£ç è¡Œï¼‰æ—¶è¿”å›ä¸€ä¸ª `Future` å¯¹è±¡ï¼Œç„¶åç­‰å¾… `await` è¡¨è¾¾å¼æ‰§è¡Œå®Œæ¯•åç»§ç»­æ‰§è¡Œã€‚

ä½¿ç”¨ `tryã€catch` ä»¥åŠ `finally` æ¥å¤„ç†ä½¿ç”¨ `await` å¯¼è‡´çš„å¼‚å¸¸ã€‚

```dart
try {
  version = await lookUpVersion();
} catch (e) {
  // React to inability to look up the version
}
```

å¯ä»¥åœ¨å¼‚æ­¥å‡½æ•°ä¸­å¤šæ¬¡ä½¿ç”¨ await å…³é”®å­—ã€‚

```dart
var entrypoint = await findEntryPoint();
var exitCode = await runExecutable(entrypoint, args);
await flushThenExit(exitCode);
```

> `await` è¡¨è¾¾å¼çš„è¿”å›å€¼é€šå¸¸æ˜¯ä¸€ä¸ª `Future` å¯¹è±¡ï¼›å¦‚æœä¸æ˜¯çš„è¯ä¹Ÿä¼šè‡ªåŠ¨å°†å…¶åŒ…è£¹åœ¨ä¸€ä¸ª `Future` å¯¹è±¡é‡Œã€‚ `Future` å¯¹è±¡ä»£è¡¨ä¸€ä¸ªâ€œpromiseâ€ï¼Œ `await` è¡¨è¾¾å¼ä¼šé˜»å¡ç›´åˆ°éœ€è¦çš„å¯¹è±¡è¿”å›ã€‚

> å¦‚æœåœ¨ä½¿ç”¨ `await` æ—¶å¯¼è‡´ç¼–è¯‘é”™è¯¯ï¼Œè¯·ç¡®ä¿ `await` åœ¨ä¸€ä¸ªå¼‚æ­¥å‡½æ•°ä¸­ä½¿ç”¨ã€‚

### å£°æ˜å¼‚æ­¥å‡½æ•°

**å¼‚æ­¥å‡½æ•°** æ˜¯å‡½æ•°ä½“ç”± `async` å…³é”®å­—æ ‡è®°çš„å‡½æ•°ã€‚

- å°†å…³é”®å­— async æ·»åŠ åˆ°å‡½æ•°å¹¶è®©å…¶è¿”å›ä¸€ä¸ª `Future` å¯¹è±¡ã€‚

```dart
Future<String> lookUpVersion() async => '1.0.0';
```

> å‡½æ•°ä½“ä¸éœ€è¦ä½¿ç”¨ `Future API`ã€‚å¦‚æœ‰å¿…è¦ï¼ŒDart ä¼šåˆ›å»º `Future` å¯¹è±¡ã€‚  
> å¦‚æœå‡½æ•°æ²¡æœ‰è¿”å›æœ‰æ•ˆå€¼ï¼Œéœ€è¦è®¾ç½®å…¶è¿”å›ç±»å‹ä¸º `Future<void>`ã€‚

[å¼‚æ­¥ç¼–ç¨‹ï¼šä½¿ç”¨ Future å’Œ async-await](https://dart.cn/codelabs/async-await)

### å¤„ç† Stream

å¦‚æœæƒ³ä» `Stream` ä¸­è·å–å€¼ï¼Œå¯ä»¥æœ‰ä¸¤ç§é€‰æ‹©ï¼š

- ä½¿ç”¨ `async` å…³é”®å­—å’Œä¸€ä¸ª `å¼‚æ­¥å¾ªç¯`ï¼ˆä½¿ç”¨ `await for` å…³é”®å­—æ ‡è¯†ï¼‰ã€‚
- ä½¿ç”¨ `Stream API`

> åœ¨ä½¿ç”¨ `await for` å…³é”®å­—å‰ï¼Œç¡®ä¿å…¶å¯ä»¥ä»¤ä»£ç é€»è¾‘æ›´åŠ æ¸…æ™°å¹¶ä¸”æ˜¯çœŸçš„éœ€è¦ç­‰å¾…æ‰€æœ‰çš„ç»“æœæ‰§è¡Œå®Œæ¯•ã€‚  
> ä¾‹å¦‚ï¼Œé€šå¸¸ä¸åº”è¯¥åœ¨ UI äº‹ä»¶ç›‘å¬å™¨ä¸Šä½¿ç”¨ `await for` å…³é”®å­—ï¼Œå› ä¸º UI æ¡†æ¶å‘å‡ºçš„äº‹ä»¶æµæ˜¯æ— ç©·å°½çš„ã€‚

```dart
await for (varOrType identifier in expression) {
  // Executes each time the stream emits a value.
}
```

è¡¨è¾¾å¼(expression) çš„ç±»å‹å¿…é¡»æ˜¯ Streamã€‚æ‰§è¡Œæµç¨‹å¦‚ä¸‹ï¼š

- 1 ç­‰å¾…ç›´åˆ° Stream è¿”å›ä¸€ä¸ªæ•°æ®ã€‚
- 2 ä½¿ç”¨ 1 ä¸­ Stream è¿”å›çš„æ•°æ®æ‰§è¡Œå¾ªç¯ä½“ã€‚
- 3 é‡å¤ 1ã€2 è¿‡ç¨‹ç›´åˆ° Stream æ•°æ®è¿”å›å®Œæ¯•ã€‚

ä½¿ç”¨ `break` å’Œ `return` è¯­å¥å¯ä»¥åœæ­¢æ¥æ”¶ Stream æ•°æ®ï¼Œè¿™æ ·å°±è·³å‡ºäº†å¾ªç¯å¹¶å–æ¶ˆæ³¨å†Œç›‘å¬ Streamã€‚

**å¦‚æœåœ¨å®ç°å¼‚æ­¥ for å¾ªç¯æ—¶é‡åˆ°ç¼–è¯‘æ—¶é”™è¯¯ï¼Œè¯·æ£€æŸ¥ç¡®ä¿ await for å¤„äºå¼‚æ­¥å‡½æ•°ä¸­ã€‚**

```dart
void main() async {
  // ...
  await for (final request in requestServer) {
    handleRequest(request);
  }
  // ...
}
```

# (å) å…¶ä»–

## ç”Ÿæˆå™¨

å½“ä½ éœ€è¦å»¶è¿Ÿåœ°ç”Ÿæˆä¸€è¿ä¸²çš„å€¼æ—¶ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨ ç”Ÿæˆå™¨å‡½æ•°ã€‚Dart å†…ç½®æ”¯æŒä¸¤ç§å½¢å¼çš„ç”Ÿæˆå™¨æ–¹æ³•ï¼š

- **åŒæ­¥** ç”Ÿæˆå™¨ï¼šè¿”å›ä¸€ä¸ª Iterable å¯¹è±¡ã€‚
- **å¼‚æ­¥** ç”Ÿæˆå™¨ï¼šè¿”å›ä¸€ä¸ª Stream å¯¹è±¡ã€‚

é€šè¿‡åœ¨å‡½æ•°ä¸ŠåŠ  `sync*` å…³é”®å­—å¹¶å°†è¿”å›å€¼ç±»å‹è®¾ç½®ä¸º _Iterable_ æ¥å®ç°ä¸€ä¸ª **åŒæ­¥** ç”Ÿæˆå™¨å‡½æ•°ï¼Œåœ¨å‡½æ•°ä¸­ä½¿ç”¨ _yield_ è¯­å¥æ¥ä¼ é€’å€¼ã€‚
å®ç° **å¼‚æ­¥** ç”Ÿæˆå™¨å‡½æ•°ä¸åŒæ­¥ç±»ä¼¼ï¼Œåªä¸è¿‡å…³é”®å­—ä¸º `async*` å¹¶ä¸”è¿”å›å€¼ä¸º _Stream_ã€‚
å¦‚æœç”Ÿæˆå™¨æ˜¯é€’å½’è°ƒç”¨çš„ï¼Œå¯æ˜¯ä½¿ç”¨ `yield*` è¯­å¥æå‡æ‰§è¡Œæ€§èƒ½ã€‚

```dart
Iterable<int> naturalsDownFrom(int n) sync* {
  if (n > 0) {
    yield n;
    yield* naturalsDownFrom(n - 1);
  }
}
```

## å¯è°ƒç”¨ç±»

é€šè¿‡å®ç°ç±»çš„ call() æ–¹æ³•ï¼Œå…è®¸ä½¿ç”¨ç±»ä¼¼å‡½æ•°è°ƒç”¨çš„æ–¹å¼æ¥ä½¿ç”¨è¯¥ç±»çš„å®ä¾‹ã€‚

## éš”ç¦»åŒº

å¤§å¤šæ•°è®¡ç®—æœºä¸­ï¼Œç”šè‡³åœ¨ç§»åŠ¨å¹³å°ä¸Šï¼Œéƒ½åœ¨ä½¿ç”¨å¤šæ ¸ CPUã€‚
ä¸ºäº†æœ‰æ•ˆåˆ©ç”¨å¤šæ ¸æ€§èƒ½ï¼Œå¼€å‘è€…ä¸€èˆ¬ä½¿ç”¨å…±äº«å†…å­˜çš„æ–¹å¼è®©çº¿ç¨‹å¹¶å‘åœ°è¿è¡Œã€‚
ç„¶è€Œï¼Œå¤šçº¿ç¨‹å…±äº«æ•°æ®é€šå¸¸ä¼šå¯¼è‡´å¾ˆå¤šæ½œåœ¨çš„é—®é¢˜ï¼Œå¹¶å¯¼è‡´ä»£ç è¿è¡Œå‡ºé”™ã€‚

ä¸ºäº†è§£å†³å¤šçº¿ç¨‹å¸¦æ¥çš„å¹¶å‘é—®é¢˜ï¼ŒDart ä½¿ç”¨ `isolate` æ›¿ä»£çº¿ç¨‹ï¼Œæ‰€æœ‰çš„ Dart ä»£ç å‡è¿è¡Œåœ¨ä¸€ä¸ª `isolate` ä¸­ã€‚
æ¯ä¸€ä¸ª `isolate` æœ‰å®ƒè‡ªå·±çš„å †å†…å­˜ä»¥ç¡®ä¿å…¶çŠ¶æ€ä¸è¢«å…¶å®ƒ `isolate` è®¿é—®ã€‚

**æ‰€æœ‰çš„ Dart ä»£ç éƒ½æ˜¯åœ¨ä¸€ä¸ª isolate ä¸­è¿è¡Œï¼Œè€Œéçº¿ç¨‹ã€‚**
**æ¯ä¸ª isolate éƒ½æœ‰ä¸€ä¸ªå•ç‹¬çš„æ‰§è¡Œçº¿ç¨‹ï¼Œå¹¶ä¸”ä¸ä¸å…¶ä»–çš„ isolate å…±äº«ä»»ä½•å¯å˜å¯¹è±¡ã€‚**

## Typedefs

**ç±»å‹åˆ«å**æ˜¯å¼•ç”¨æŸä¸€ç±»å‹çš„ç®€ä¾¿æ–¹æ³•ï¼Œå› ä¸ºå…¶ä½¿ç”¨å…³é”®å­— `typedef`ï¼Œå› æ­¤é€šå¸¸è¢«ç§°ä½œ `typedef`ã€‚

ä¸‹é¢æ˜¯ä¸€ä¸ªä½¿ç”¨ IntList æ¥å£°æ˜å’Œä½¿ç”¨ç±»å‹åˆ«åçš„ä¾‹å­:

```dart
typedef IntList = List<int>;
IntList il = [1, 2, 3];
```

ç±»å‹åˆ«åå¯ä»¥æœ‰ç±»å‹å‚æ•°:

```dart
typedef ListMapper<X> = Map<X, List<X>>;

Map<String, List<String>> m1 = {}; // å£°æ˜ç±»å‹æ¯”è¾ƒå†—é•¿
ListMapper<String> m2 = {}; // è¿™æ ·æ›´ç®€æ´çš„æ–¹å¼
```

é’ˆå¯¹å‡½æ•°ï¼Œåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æ¨èä½¿ç”¨ å†…è”å‡½æ•°ç±»å‹ æ›¿ä»£ typedefsã€‚

## å…ƒæ•°æ®

ä½¿ç”¨å…ƒæ•°æ®å¯ä»¥ä¸ºä»£ç å¢åŠ ä¸€äº›é¢å¤–çš„ä¿¡æ¯ã€‚å…ƒæ•°æ®æ³¨è§£ä»¥ `@` å¼€å¤´ï¼Œå…¶åç´§è·Ÿä¸€ä¸ªç¼–è¯‘æ—¶å¸¸é‡ï¼ˆæ¯”å¦‚ deprecatedï¼‰æˆ–è€…è°ƒç”¨ä¸€ä¸ªå¸¸é‡æ„é€ å‡½æ•°ã€‚

Dart ä¸­æœ‰ä¸‰ä¸ªæ³¨è§£æ˜¯æ‰€æœ‰ä»£ç éƒ½å¯ä»¥ä½¿ç”¨çš„ï¼š `@deprecated`ã€`@Deprecated` å’Œ `@override`ã€‚ä¹Ÿå¯ä»¥è‡ªå®šä¹‰å…ƒæ•°æ®æ³¨è§£ã€‚

ä¸‹é¢çš„ç¤ºä¾‹å®šä¹‰äº†ä¸€ä¸ªå¸¦æœ‰ä¸¤ä¸ªå‚æ•°çš„ `@todo` æ³¨è§£ï¼š

```dart
library todo;

class Todo {
  final String who;
  final String what;

  const Todo(this.who, this.what);
}
```

ä½¿ç”¨ @Todo æ³¨è§£çš„ç¤ºä¾‹ï¼š

```dart
import 'todo.dart';

@Todo('seth', 'make this do something')
void doSomething() {
  print('do something');
}
```

å…ƒæ•°æ®å¯ä»¥åœ¨ libraryã€classã€typedefã€type parameterã€ constructorã€factoryã€functionã€fieldã€parameter æˆ–è€… variable å£°æ˜ä¹‹å‰ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥åœ¨ import æˆ– export ä¹‹å‰ä½¿ç”¨ã€‚
å¯ä½¿ç”¨åå°„åœ¨è¿è¡Œæ—¶è·å–å…ƒæ•°æ®ä¿¡æ¯ã€‚

## æ³¨é‡Š

å•è¡Œæ³¨é‡Š

- å•è¡Œæ³¨é‡Šä»¥ `//` å¼€å§‹ã€‚æ‰€æœ‰åœ¨ `//` å’Œè¯¥è¡Œç»“å°¾ä¹‹é—´çš„å†…å®¹å‡è¢«ç¼–è¯‘å™¨å¿½ç•¥ã€‚

å¤šè¡Œæ³¨é‡Š

- å¤šè¡Œæ³¨é‡Šä»¥ `/*` å¼€å§‹ï¼Œä»¥ `*/` ç»“å°¾ã€‚
- æ‰€æœ‰åœ¨ `/*` å’Œ `*/` ä¹‹é—´çš„å†…å®¹å‡è¢«ç¼–è¯‘å™¨å¿½ç•¥ï¼ˆä¸ä¼šå¿½ç•¥æ–‡æ¡£æ³¨é‡Šï¼‰ï¼Œå¤šè¡Œæ³¨é‡Šå¯ä»¥åµŒå¥—ã€‚

æ–‡æ¡£æ³¨é‡Š
// æ–‡æ¡£æ³¨é‡Šå¯ä»¥æ˜¯å¤šè¡Œæ³¨é‡Šï¼Œä¹Ÿå¯ä»¥æ˜¯å•è¡Œæ³¨é‡Šï¼Œæ–‡æ¡£æ³¨é‡Šä»¥ `///` æˆ–è€… `/**` å¼€å§‹ã€‚
// åœ¨è¿ç»­è¡Œä¸Šä½¿ç”¨ `///` ä¸å¤šè¡Œæ–‡æ¡£æ³¨é‡Šå…·æœ‰ç›¸åŒçš„æ•ˆæœã€‚
// åœ¨æ–‡æ¡£æ³¨é‡Šä¸­ï¼Œé™¤éç”¨ä¸­æ‹¬å·æ‹¬èµ·æ¥ï¼Œå¦åˆ™åˆ†æå™¨ä¼šå¿½ç•¥æ‰€æœ‰æ–‡æœ¬ã€‚
// ä½¿ç”¨ä¸­æ‹¬å·å¯ä»¥å¼•ç”¨ç±»ã€æ–¹æ³•ã€å­—æ®µã€é¡¶çº§å˜é‡ã€å‡½æ•°å’Œå‚æ•°ã€‚
// æ‹¬å·ä¸­çš„ç¬¦å·ä¼šåœ¨å·²è®°å½•çš„ç¨‹åºå…ƒç´ çš„è¯æ³•åŸŸä¸­è¿›è¡Œè§£æã€‚
